!function(){try{var n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=Error().stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="e4442869-b30c-4ef3-8555-4d62f66fab7c",n._sentryDebugIdIdentifier="sentry-dbid-e4442869-b30c-4ef3-8555-4d62f66fab7c")}catch(n){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"ec45b404"};"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4846],{60100:function(n,e,r){r.d(e,{FW:function(){return d},NH:function(){return g}});var t=r(41733),o=r(21262),i=r(71440),u=r(95420),l=r(72175),s=r(58995);function a(){var n=(0,o._)(["\n  fragment PublishReplData on Repl {\n    id\n    url\n    title\n    description\n    iconUrl\n    lastPublishedAt\n    publishedAs\n    imageUrl\n    isRenamed\n    templateInfo {\n      iconUrl\n    }\n    replViewSettings {\n      id\n      defaultView\n      replImage\n      replFile\n    }\n    tags {\n      id\n      isOfficial\n    }\n    authorizations {\n      editMetadata {\n        isAuthorized\n      }\n      editFileContents {\n        isAuthorized\n      }\n      publish {\n        isAuthorized\n      }\n    }\n    ...CrosisContextRepl\n    ...PublishedReplShareInfoReplData\n  }\n  ","\n  ","\n"]);return a=function(){return n},n}function c(){var n=(0,o._)(["\n  fragment PublishCurrentUser on CurrentUser {\n    id\n    image\n    isTemplateDeveloper: hasRole(role: TEMPLATE_DEVELOPER)\n    ...CrosisContextCurrentUser\n  }\n  ","\n"]);return c=function(){return n},n}function f(){var n=(0,o._)(["\n  query PublishCurrentUser {\n    currentUser {\n      id\n      ...PublishCurrentUser\n    }\n  }\n  ","\n"]);return f=function(){return n},n}var p={},d=(0,i.Ps)(a(),u.C,l.B),h=(0,i.Ps)(c(),u.D),v=(0,i.Ps)(f(),h);function g(n){var e=(0,t._)({},p,n);return s.a(v,e)}},72175:function(n,e,r){r.d(e,{B:function(){return i}});var t=r(21262);function o(){var n=(0,t._)(["\n  fragment PublishedReplShareInfoReplData on Repl {\n    id\n    url\n    publishedAs\n    title\n  }\n"]);return o=function(){return n},n}var i=(0,r(71440).Ps)(o())},30177:function(n,e,r){r.d(e,{sI:function(){return u}});var t=r(21262);function o(){var n=(0,t._)(["\n  fragment ReplViewerOutputOverlayRepl on Repl {\n    id\n    title\n    imageUrl\n    lastPublishedAt\n    authorizations {\n      editMetadata {\n        isAuthorized\n      }\n    }\n  }\n"]);return o=function(){return n},n}function i(){var n=(0,t._)(["\n  mutation ReplViewerOutputOverlayUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        imageUrl\n      }\n    }\n  }\n"]);return i=function(){return n},n}var u=(0,r(71440).Ps)(o());i()},84573:function(n,e,r){r.d(e,{Z:function(){return E}});var t=r(66626),o=r(74985),i=r(69170),u=r(60305),l=r(15235),s=r(82230),a=r(94778),c=r(44049),f=r(72093),p=r(85438),d=r(41733),h=r(21262),v=r(71440),g=r(33204),m=r(99165);function y(){var n=(0,h._)(["\n  mutation UnpublishReplUnpublish($input: UnpublishReplFromCommunityInput!) {\n    unpublishReplFromCommunity(input: $input) {\n      ... on Repl {\n        id\n        ...ReplViewReplActionsPermissions\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n  ","\n"]);return y=function(){return n},n}var R={},b=(0,v.Ps)(y(),g.jN),_=a.K.form;function E(n){var e,r,h=n.repl,v=n.source,g=n.onDone,y=(0,i.Z)(),E=y.showConfirm,C=y.showError,w=(0,t._)((e={variables:{input:{replId:h.id}},onCompleted:function(n){if("Repl"===n.unpublishReplFromCommunity.__typename){var e=n.unpublishReplFromCommunity.likeCount;(0,u.j)(u.U3.REPL_UNPUBLISHED,{source:v,numLikes:e,replType:h.publishedAs===p.O2.Template?"template_repl":"regular_repl"}),E("Repl removed from the community.")}else"NotFoundError"===n.unpublishReplFromCommunity.__typename||"UnauthorizedError"===n.unpublishReplFromCommunity.__typename?C(n.unpublishReplFromCommunity.message):C("An unexpected error occurred.");g()},onError:function(){C("Something went wrong. Please try again.")},update:function(n){n.modify({id:n.identify({__typename:"Repl",id:h.id}),fields:{comments:function(n,e){return e.DELETE},tags:function(n,e){return e.DELETE}}})}},r=(0,d._)({},R,e),m.D(b,r)),2),O=w[0],N=w[1].loading;return(0,o.BX)(a.G,{css:[f.l0.colWithGap(24)],children:[(0,o.tZ)(s.xv,{variant:"subheadBig",children:"Unpublish this Repl from the Community"}),(0,o.BX)(_,{onSubmit:function(n){n.preventDefault(),O()},css:[f.l0.colWithGap(32)],children:[(0,o.tZ)(s.xv,{children:"Unpublishing a Repl will remove it from the Community. This action will delete all associated posts and tags. The Repl and all its comments will still be visible in your profile, but will not be shown in the Community or Trending views anymore. You can always re-publish the Repl again later."}),(0,o.BX)(a.G,{css:[f.l0.rowWithGap(8),f.l0.justify.end],children:[(0,o.tZ)(a.G,{children:(0,o.tZ)(l.zx,{type:"button",text:"Cancel",onClick:function(){return g()}})}),(0,o.tZ)(a.G,{children:(0,o.tZ)(l.zx,{disabled:N,colorway:"negative",text:N?"Unpublishing...":"Yes, unpublish this Repl",type:"submit",iconLeft:(0,o.tZ)(c.Z,{})})})]})]})]})}},19393:function(n,e,r){r.d(e,{S:function(){return u}});var t=r(85733),o=r(91087),i=r(50959);function u(){var n=(0,o.mC)(),e=(0,t.Z)(n);return(0,i.useCallback)(function(){var n,r;return!Number.isFinite(r=parseInt(null==(n=e.current)?void 0:n.variation("flag-container-retry-minimum-ms",0),10))||r<0?0:r},[e])}},39126:function(n,e,r){r.d(e,{Z:function(){return C}});var t={};r.r(t),r.d(t,{checkAndTrack:function(){return b},ensureTrackedFile:function(){return m},storeOp:function(){return y}});var o=r(60305),i=r(27387),u=r(66626),l=r(96583),s=r(75958),a=r(41733),c={};function f(n,e,r){var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n.info("ot client dataloss",(0,a._)({case:e,startTime:r.startTime,opsSinceFlush:r.opsSinceFlush,whileReconnecting:r.whileReconnecting,replid:r.replId,filePath:r.filePath},t))}var p=r(70090),d={replsList:function(){return"dataLossRepls"},replFiles:function(n){return"dataLossReplFiles".concat(n)},latestOp:function(n,e){return"dataLossLatestOp--".concat(n,"--").concat(e)},latestFlushedOp:function(n,e){return"dataLossLatestFlushed--".concat(n,"--").concat(e)},latestOwnOp:function(n,e){return"dataLosslatestOwnOp--".concat(n,"--").concat(e)},opsSinceFlush:function(n,e){return"dataLossOpsSinceFlush--".concat(n,"--").concat(e)}};function h(){var n=s.Z.get(d.replsList(),"array");return n||(n=[],s.Z.set(d.replsList(),n)),n}function v(n){var e=s.Z.get(d.replFiles(n),"array");return e||(e=[],s.Z.set(d.replFiles(n),e)),e}function g(n){var e=v(n),r=!0,t=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var l=i.value;"string"==typeof l&&function(n,e){s.Z.remove(d.latestOp(n,e)),s.Z.remove(d.latestFlushedOp(n,e)),s.Z.remove(d.latestOwnOp(n,e));var r=v(n).filter(function(n){return n!==e});s.Z.set(d.replFiles(n),r)}(n,l)}}catch(n){t=!0,o=n}finally{try{r||null==u.return||u.return()}finally{if(t)throw o}}s.Z.remove(d.replFiles(n));var a=h().filter(function(e){return e!==n});s.Z.set(d.replsList(),a)}function m(n){var e,r=n.replId,t=n.filePath;(e=h()).includes(r)||(e.length>20?(g(e[0]),e[0]=r):e.push(r),s.Z.set(d.replsList(),e));var o=v(r);o.includes(t)||(o.length>20?(g(o[0]),o[0]=t):o.push(t),s.Z.set(d.replFiles(r),o))}function y(n){var e=n.filePath,r=n.replId,t=n.opType,o=n.op;!function(n){var e=n.filePath,r=n.replId,t=n.opType,o=n.logger,i=n.isReconnecting,u=f.bind(null,o),l="".concat(r,"--").concat(e);c[l]||(c[l]={replId:r,filePath:e,timer:null,startTime:null,whileReconnecting:0,opsSinceFlush:0});var s=c[l];if("latestFlushedOp"===t){delete c[l];var a=s.startTime;if(a){var p=Date.now()-a;p>6e4&&u("flush_delay_received",s,{elapsed:p})}var d=s.timer;d&&(clearTimeout(d),s.timer=null)}else{s.opsSinceFlush+=1,i&&(s.whileReconnecting+=1);var h,v=null!==(h=s.startTime)&&void 0!==h?h:Date.now();s.startTime=v,s.timer||(s.timer=setTimeout(function(){u("flush_delay_timeout",s)},6e4)),150===s.opsSinceFlush?u("flush_delay_small",s):1e3===s.opsSinceFlush&&u("flush_delay_large",s)}}({filePath:e,replId:r,opType:t,logger:n.logger,isReconnecting:n.isReconnecting}),s.Z.set(d[t](r,e),o)}var R={};function b(n){return _.apply(this,arguments)}function _(){return(_=(0,i._)(function(n){var e,r,t,o,a,c,f,h;return(0,l.Jh)(this,function(v){var g;return e=n.filePath,r=n.replId,t=n.serverVersion,o=n.serverContent,a=n.fetchOps,c=n.logger,R[e+r]||(R[e+r]=!0,f=function(n,e){var r={latestOp:null,latestFlushedOp:null,latestOwnOp:null},t=Object.keys(r),o=!0,i=!1,u=void 0;try{for(var l,a=t[Symbol.iterator]();!(o=(l=a.next()).done);o=!0){var c=l.value,f=s.Z.get(d[c](n,e),"object");f&&f&&"object"==typeof f&&"number"==typeof f.crc32&&"number"==typeof f.version&&(r[c]=f)}}catch(n){i=!0,u=n}finally{try{o||null==a.return||a.return()}finally{if(i)throw u}}return r}(r,e),h=p.str(o)>>>0,Object.keys(f).forEach((g=(0,i._)(function(n){var e,r,o;return(0,l.Jh)(this,function(i){switch(i.label){case 0:if(!(e=f[n]))return[2];if(t<e.version)return c.info("ot client dataloss",{opType:n,case:"server_forgot"}),[2];if(t===e.version)return h!==e.crc32&&c.info("ot client dataloss",{opType:n,case:"crc32_mismatch"}),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a(e.version,e.version)];case 2:return r=u._.apply(void 0,[i.sent(),1])[0],[3,4];case 3:return o=i.sent(),c.info("ot client dataloss",{opType:n,case:"error_fetching_op",originalError:String(o)}),[2];case 4:if(!r)return c.info("ot client dataloss",{opType:n,case:"op_not_found"}),[2];return r.crc32!==e.crc32&&c.info("ot client dataloss",{opType:n,case:"crc32_mismatch"}),[2]}})}),function(n){return g.apply(this,arguments)}))),[2]})})).apply(this,arguments)}var E=r(38938);function C(n){var e=n.container;return(0,E.Z)({container:e,dataloss:t,track:o.j})}},46180:function(n,e,r){r.d(e,{Z:function(){return l}});var t=r(85421),o=r.n(t),i=r(6949),u=r(49500);function l(n){var e=n.throwBsod,r=n.tags,t=n.extras,l=n.origin,s=n.onNonBsodUnrecoverableError,a=void 0===s?function(){}:s;return function(n){var s=(0,i.ZP)(n);if(s===i.Gs.NotFound){o().push("/home","~/");return}if(s===i.Gs.LanguageTokenDenied){window.location.reload();return}if(s){a(s);return}u.error(n),e({error:n,tags:r,extras:t,origin:l})}}},1813:function(n,e,r){r.d(e,{I7:function(){return m},Id:function(){return g},ic:function(){return b},jT:function(){return v},qg:function(){return R},uV:function(){return y}});var t=r(41733),o=r(30509),i=r(7954),u=r(41974),l=r(42650),s=r(39460),a=r(37697),c=r(50959),f=(0,l.cn)(null),p=(0,l.cn)(null,function(n,e,r){var u=r.error,l=r.tags,s=r.extras,a=r.origin,c=(0,o._)((0,t._)({},l),{origin:a});"statusCode"in u?c.statusCode=u.statusCode:"status"in u&&(c.statusCode=u.status),n(f)||e(f,{eventId:(0,i.I)(u,{tags:c,extras:s}),error:u,sentry:{tags:c,extras:s},origin:a})}),d=(0,l.cn)(null,function(n,e){e(f,null)}),h=(0,l.cn)(new Map);function v(){return(0,a.lV)((0,c.useCallback)(function(n,e,r){var t=r.filePath;return n(h).get(t)},[]))}function g(){return(0,a.lV)((0,c.useCallback)(function(n,e,r){var t=r.filePath,o=r.version;e(h,function(n){return(0,u.Uy)(n,function(n){n.set(t,o)})})},[]))}function m(){return(0,a.lV)((0,c.useCallback)(function(n,e,r){var t=r.filePath;e(h,function(n){return(0,u.Uy)(n,function(n){n.delete(t)})})},[]))}function y(){return(0,s.b9)(p)}function R(){return[(0,s.Dv)(f),y()]}function b(){return(0,s.b9)(d)}},36632:function(n,e,r){r.d(e,{Z:function(){return g},l:function(){return v}});var t=r(27387),o=r(63257),i=r(96583),u=r(12663),l=r(87137),s=r(57253),a=r(73372),c=r(39171),f=r(367),p=r(63072),d=r(91620).lW,h=r(9797),v=".replit";function g(n){var e,r,g,m,y=n.container,R=n.fs,b=n.ctx,_=(0,u.ZP)();_.setMaxListeners(50);var E=null,C=null,w=null;function O(){return N.apply(this,arguments)}function N(){return(N=(0,t._)(function(){return(0,i.Jh)(this,function(n){return E&&"open"===E.status?[2,E]:[2,new Promise(function(n){_.once(l.zW.CHANNEL_OPENED,function(e){n(e)})})]})})).apply(this,arguments)}(function(){F.apply(this,arguments)})(),y.openChannel({service:"dotreplit"},function(n){var e=n.channel;return E=e,_.emit(l.zW.CHANNEL_OPENED,e),function(){E=null}});var P=!1;function F(){return(F=(0,t._)(function(){return(0,i.Jh)(this,function(n){return R.watchDir(a.Ql,{onChange:function(n){if(!n.some(function(n){return n.filename===v&&n.type===s.Tv.File})){(null==C?void 0:C.error)!==l.Yt.NotFound&&(C={error:l.Yt.NotFound,errorMessage:"",config:null},_.emit(l.zW.CHANGE,C));return}P||(P=!0,R.watchFile(v,{onChange:function(){C=null,L.getConfig({bypassCache:!0}).then(function(n){_.emit(l.zW.CHANGE,n)})},onMoveOrDelete:function(){P=!1},onError:function(n,e){C=null,P=!1,n.code||y.unrecoverableError(n,e)}}))},onError:function(n,e){y.unrecoverableError(n,e)}}),[2]})})).apply(this,arguments)}function T(){return(T=(0,t._)(function(){return(0,i.Jh)(this,function(n){switch(n.label){case 0:return C=null,w||(w=function(){return U.apply(this,arguments)}()),[4,w];case 1:return C=n.sent(),w=null,[2,C]}})})).apply(this,arguments)}function U(){return(U=(0,t._)(function(){return(0,i.Jh)(this,function(n){var e;return[2,(0,f.DW)(b,"dotreplit.getConfigFromServer",(e=(0,t._)(function(n,e){var r,t,o,u;return(0,i.Jh)(this,function(i){switch(i.label){case 0:var s,a,c;return null==e||e.setAttributes((s={},(null==(a=y.getConnectionMetadata())?void 0:a.token)&&(s.tokenCluster=function(n){var e=n.split(".");if(4!==e.length)throw Error("Invalid token: should have exactly 4 parts: "+n);for(var r=e[2].replace(/-/g,"+").replace(/_/g,"/");r.length%4;)r+="=";var t=window.atob(r);if(t.length<64)throw Error("Invalid token: signed part is too short: "+t.length);var o=t.substring(0,t.length-64);return p.api.token.ReplToken.decode(d.from(o,"base64"))}(a.token).cluster),c=!!window.performance.getEntriesByName(h.Iy.pageNavStart,"mark").length,s.ssr=c,s)),[4,O()];case 1:if("closed"===(t=i.sent()).status)return[2,{error:l.Yt.Disconnected,errorMessage:"channel closed",config:null}];return[4,t.request({dotReplitGetRequest:{},traceInfo:n?(0,f.Rg)(n):void 0})];case 2:if((o=i.sent()).channelClosed)return[2,{error:l.Yt.Disconnected,errorMessage:"channel closed",config:null}];if(o.error){if(o.error.includes("unable to decode"))return[2,{error:l.Yt.ParseError,errorMessage:o.error,config:null}];if(o.error.includes("no such file"))return[2,{error:l.Yt.NotFound,errorMessage:o.error,config:null}];return[2,{error:l.Yt.Unknown,errorMessage:o.error,config:null}]}if(!(u=null===(r=o.dotReplitGetResponse)||void 0===r?void 0:r.dotReplit))return y.unrecoverableError(Error("Dotreplit responded with no error and no config")),[2,{error:l.Yt.Unknown,errorMessage:"Expected dotReplitGetResponse to include dotReplit",config:null}];return[2,{error:null,errorMessage:null,config:u}]}})}),function(n,r){return e.apply(this,arguments)}))]})})).apply(this,arguments)}var D=(e=(0,t._)(function(n){var e;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return[4,R.stat(v)];case 1:if(r.sent().exists)return[3,3];return[4,R.writeFile(v,"")];case 2:r.sent(),r.label=3;case 3:return[4,O()];case 4:return[4,r.sent().request({dotReplitUpdateRequest:{ops:n}})];case 5:if((e=r.sent()).channelClosed)return[2,{errorMessage:"Channel closed.",error:l.au.ChannelClosed,response:null}];if(e.error){if(e.error.includes("could not parse json")||e.error.includes("is not json")||e.error.includes("parsing value field")||e.error.includes("missing field"))return[2,{errorMessage:e.error,error:l.au.JSONParseError,response:null}];if(e.error.includes("could not read file"))return[2,{errorMessage:e.error,error:l.au.NotFound,response:null}];if(e.error.includes("could not parse toml"))return[2,{errorMessage:e.error,error:l.au.TOMLParseError,response:null}];if(e.error.includes("unknown variant"))return[2,{errorMessage:e.error,error:l.au.OpType,response:null}];if(e.error.includes("could not write to file"))return[2,{errorMessage:e.error,error:l.au.CouldNotWrite,response:null}];if(e.error.includes("could not read line"))return[2,{errorMessage:e.error,error:l.au.ReadLine,response:null}];return[2,{errorMessage:e.error,error:l.au.Unknown,response:null}]}if(!e.dotReplitUpdateResponse)throw Error("Expected .replit to be updated");return[2,{response:e.dotReplitUpdateResponse,error:null,errorMessage:null}]}})}),function(n){return e.apply(this,arguments)}),L={watch:function(n){var e=!1,r=!1,t=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];r=!0,n.apply(void 0,(0,o._)(t))};return _.on(l.zW.CHANGE,t),L.getConfig().then(function(n){e||r||t(n)}),function(){e=!0,_.removeListener(l.zW.CHANGE,t)}},getConfig:function(n){return(0,t._)(function(){return(0,i.Jh)(this,function(e){return(null==n?void 0:n.bypassCache)||!C?[2,function(){return T.apply(this,arguments)}()]:[2,C]})})()},getRunConfig:function(){return(0,t._)(function(){var n,e;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return[4,O()];case 1:return[4,r.sent().request({runConfigGetRequest:{}})];case 2:if((n=r.sent()).channelClosed)return[2,this.getRunConfig()];if(!n.runConfigGetResponse)throw null!==(e=n.error)&&void 0!==e?e:Error("expected run config");return[2,n.runConfigGetResponse]}})}).apply(this)},updateDotReplit:(r=[],g=400,m=(0,c.Z)((0,t._)(function(){var n;return(0,i.Jh)(this,function(e){switch(e.label){case 0:return[4,D(r)];case 1:return n=e.sent(),r=[],[2,n]}})}),{wait:g}),function(n,e){e&&(g=e);var t=!0,o=!1,i=void 0;try{for(var u,l=n[Symbol.iterator]();!(t=(u=l.next()).done);t=!0)!function(){var n=u.value,e=r.findIndex(function(e){return e.path===n.path});-1!==e?r[e]=n:r.push(n)}()}catch(n){o=!0,i=n}finally{try{t||null==l.return||l.return()}finally{if(o)throw i}}return m()})};return L}},87137:function(n,e,r){var t,o,i,u,l,s;r.d(e,{Yt:function(){return t},au:function(){return o},zW:function(){return i}}),(u=t||(t={})).NotFound="NOT_FOUND",u.ParseError="PARSE_ERROR",u.Disconnected="DISCONNECTED",u.Unknown="UNKOWN_ERROR",(l=o||(o={})).ChannelClosed="CHANNEL_CLOSED",l.JSONParseError="JSON_PARSE_ERROR",l.NotFound="NOT_FOUND",l.TOMLParseError="TOML_PARSE_ERROR",l.OpType="OP_TYPE",l.CouldNotWrite="COULD_NOT_WRITE",l.ReadLine="COULD_NOT_READ_LINE",l.Unknown="UNKNOWN_ERROR",(s=i||(i={})).CHANGE="CHANGE",s.CHANNEL_OPENED="CHANNEL_OPENED"}}]);
//# sourceMappingURL=4846-6c4c9cad334c6283.js.map