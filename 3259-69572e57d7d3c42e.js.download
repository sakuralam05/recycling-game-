!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2219c4ef-81c4-4555-9760-622f4903cb99",e._sentryDebugIdIdentifier="sentry-dbid-2219c4ef-81c4-4555-9760-622f4903cb99")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"ec45b404"};"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3259],{3341:function(e){e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!=i--;){var n,i,o,s=o[i];if(!e(t[s],r[s]))return!1}return!0}return t!=t&&r!=r}},2761:function(e,t,r){let n;r.d(t,{Hg:function(){return O},QK:function(){return ei},RI:function(){return l},z:function(){return S}});var i=r(3030),o=r(80403),s=r(6221);r(33083),r(41691);class l{constructor(e,t,r,n){this.fromA=e,this.toA=t,this.fromB=r,this.toB=n}offset(e,t){return new l(this.fromA+e,this.toA+e,this.fromB+t,this.toB+t)}}function f(e,t,r,n,i,o){if(e==n)return[];let s=m(e,t,r,n,i,o),c=g(e,t+s,r,n,i+s,o);t+=s,r-=c,i+=s;let u=r-t,b=(o-=c)-i;if(!u||!b)return[new l(t,r,i,o)];if(u>b){let s=e.slice(t,r).indexOf(n.slice(i,o));if(s>-1)return[new l(t,t+s,i,i),new l(t+s+b,r,o,o)]}else if(b>u){let s=n.slice(i,o).indexOf(e.slice(t,r));if(s>-1)return[new l(t,t,i,i+s),new l(r,r,i+s+u,o)]}if(1==u||1==b)return[new l(t,r,i,o)];let v=function e(t,r,n,i,o,s){let l=n-r,f=s-o;if(l<f){let l=e(i,o,s,t,r,n);return l&&[l[1],l[0],l[2]]}return l<4||2*f<l?null:p(t,r,n,i,o,s,Math.floor(l/4),-1)}(e,t,r,n,i,o);if(v){let[s,l,a]=v;return f(e,t,s,n,i,l).concat(f(e,s+a,r,n,l+a,o))}return function(e,t,r,n,i,o){let s=r-t,c=o-i;if(a<1e9&&Math.min(s,c)>16*a)return Math.min(s,c)>64*a?[new l(t,r,i,o)]:A(e,t,r,n,i,o);let u=Math.ceil((s+c)/2);h.reset(u),d.reset(u);let m=(r,o)=>e.charCodeAt(t+r)==n.charCodeAt(i+o),g=(t,i)=>e.charCodeAt(r-t-1)==n.charCodeAt(o-i-1),p=(s-c)%2!=0?d:null,b=p?null:h;for(let v=0;v<u;v++){if(v>a)return A(e,t,r,n,i,o);let w=h.advance(v,s,c,u,p,!1,m)||d.advance(v,s,c,u,b,!0,g);if(w)return function(e,t,r,n,i,o,s,a){let c=!1;return(y(e,n)||++n!=r||(c=!0),y(i,a)||++a!=s||(c=!0),c)?[new l(t,r,o,s)]:f(e,t,n,i,o,a).concat(f(e,n,r,i,a,s))}(e,t,r,t+w[0],n,i,o,i+w[1])}return[new l(t,r,i,o)]}(e,t,r,n,i,o)}let a=1e9;class c{constructor(){this.vec=[]}reset(e){this.len=e<<1;for(let e=0;e<this.len;e++)this.vec[e]=-1;this.vec[e+1]=0,this.start=this.end=0}advance(e,t,r,n,i,o,s){for(let l=-e+this.start;l<=e-this.end;l+=2){let f=n+l,a=l==-e||l!=e&&this.vec[f-1]<this.vec[f+1]?this.vec[f+1]:this.vec[f-1]+1,c=a-l;for(;a<t&&c<r&&s(a,c);)a++,c++;if(this.vec[f]=a,a>t)this.end+=2;else if(c>r)this.start+=2;else if(i){let e=n+(t-r)-l;if(e>=0&&e<this.len&&-1!=i.vec[e]){if(o){let r=i.vec[e];if(r>=t-a)return[r,n+r-e]}else if(a>=t-i.vec[e])return[a,c]}}}return null}}let h=new c,d=new c;function u(e,t){let r=1,n=Math.min(e,t);for(;r<n;)r<<=1;return r}function m(e,t,r,n,i,o){if(t==r||t==o||e.charCodeAt(t)!=n.charCodeAt(i))return 0;let s=u(r-t,o-i);for(let l=t,f=i;;){let i=l+s,a=f+s;if(i>r||a>o||e.slice(l,i)!=n.slice(f,a)){if(1==s)return l-t-(y(e,l)?0:1);s>>=1}else{if(i==r||a==o)return i-t;l=i,f=a}}}function g(e,t,r,n,i,o){if(t==r||i==o||e.charCodeAt(r-1)!=n.charCodeAt(o-1))return 0;let s=u(r-t,o-i);for(let l=r,f=o;;){let o=l-s,a=f-s;if(o<t||a<i||e.slice(o,l)!=n.slice(a,f)){if(1==s)return r-l-(y(e,l)?0:1);s>>=1}else{if(o==t||a==i)return r-o;l=o,f=a}}}function p(e,t,r,n,i,o,s,l){let f=n.slice(i,o),a=null;for(;;){if(a||s<l)return a;for(let l=t+s;;){!y(e,l)&&l++;let c=l+s;if(y(e,c)||(c+=c==l+1?1:-1),c>=r)break;let h=e.slice(l,c),d=-1;for(;-1!=(d=f.indexOf(h,d+1));){let s=m(e,c,r,n,i+d+h.length,o),f=g(e,t,l,n,i,i+d),u=h.length+s+f;(!a||a[2]<u)&&(a=[l-f,i+d-f,u])}l=c}if(l<0)return a;s>>=1}}function A(e,t,r,n,i,o){let s,a=r-t,c=o-i;if(a<c){let l=p(n,i,o,e,t,r,Math.floor(a/6),50);s=l&&[l[1],l[0],l[2]]}else s=p(e,t,r,n,i,o,Math.floor(c/6),50);if(!s)return[new l(t,r,i,o)];let[h,d,u]=s;return f(e,t,h,n,i,d).concat(f(e,h+u,r,n,d+u,o))}function b(e,t){for(let r=1;r<e.length;r++){let n=e[r-1],i=e[r];n.toA>i.fromA-t&&n.toB>i.fromB-t&&(e[r-1]=new l(n.fromA,i.toA,n.fromB,i.toB),e.splice(r--,1))}}try{n=RegExp("[\\p{Alphabetic}\\p{Number}]","u")}catch(e){}function v(e){return e>48&&e<58||e>64&&e<91||e>96&&e<123}function w(e,t){if(t==e.length)return 0;let r=e.charCodeAt(t);return r<192?v(r)?1:0:n?x(r)&&t!=e.length-1?n.test(e.slice(t,t+2))?2:0:n.test(String.fromCharCode(r))?1:0:0}function B(e,t){if(!t)return 0;let r=e.charCodeAt(t-1);return r<192?v(r)?1:0:n?M(r)&&1!=t?n.test(e.slice(t-2,t))?2:0:n.test(String.fromCharCode(r))?1:0:0}function k(e,t,r){if(t==e.length||!B(e,t))return t;for(let n=t,i=t+r;;){let r=w(e,n);if(!r)return n;if((n+=r)>i)return t}}function C(e,t,r){if(!t||!w(e,t))return t;for(let n=t,i=t-r;;){let r=B(e,n);if(!r)return n;if((n-=r)<i)return t}}let x=e=>e>=55296&&e<=56319,M=e=>e>=56320&&e<=57343;function y(e,t){return!t||t==e.length||!x(e.charCodeAt(t-1))||!M(e.charCodeAt(t))}function O(e,t,r){var n;return a=(null!==(n=null==r?void 0:r.scanLimit)&&void 0!==n?n:1e9)>>1,function(e,t,r){for(;;){b(r,1);let n=!1;for(let i=0;i<r.length;i++){let o=r[i],s,f;(s=m(e,o.fromA,o.toA,t,o.fromB,o.toB))&&(o=r[i]=new l(o.fromA+s,o.toA,o.fromB+s,o.toB)),(f=g(e,o.fromA,o.toA,t,o.fromB,o.toB))&&(o=r[i]=new l(o.fromA,o.toA-f,o.fromB,o.toB-f));let a=o.toA-o.fromA,c=o.toB-o.fromB;if(a&&c)continue;let h=o.fromA-(i?r[i-1].toA:0),d=(i<r.length-1?r[i+1].fromA:e.length)-o.toA;if(!h||!d)continue;let u=a?e.slice(o.fromA,o.toA):t.slice(o.fromB,o.toB);h<=u.length&&e.slice(o.fromA-h,o.fromA)==u.slice(u.length-h)?(r[i]=new l(o.fromA-h,o.toA-h,o.fromB-h,o.toB-h),n=!0):d<=u.length&&e.slice(o.toA,o.toA+d)==u.slice(0,d)&&(r[i]=new l(o.fromA+d,o.toA+d,o.fromB+d,o.toB+d),n=!0)}if(!n)break}return r}(e,t,f(e,0,e.length,t,0,t.length))}function D(e,t,r){return function(e,t,r){for(let n=0,i=0;i<e.length;i++){let o=e[i],s=o.toA-o.fromA,f=o.toB-o.fromB;if(s&&f||s>3||f>3){let a=i==e.length-1?t.length:e[i+1].fromA,c=o.fromA-n,h=a-o.toA,d=C(t,o.fromA,Math.min(c,5)),u=k(t,o.toA,Math.min(h,5)),m=o.fromA-d,g=u-o.toA;if(!s||!f){let h,p,A=Math.max(s,f),[b,v,w]=s?[t,o.fromA,o.toA]:[r,o.fromB,o.toB];m&&g?(A>m&&t.slice(d,o.fromA)==b.slice(w-m,w)?(d=(o=e[i]=new l(d,d+s,o.fromB-m,o.toB-m)).fromA,u=k(t,o.toA,Math.min(a-o.toA,5))):A>g&&t.slice(o.toA,u)==b.slice(v,v+g)&&(u=(o=e[i]=new l(u-s,u,o.fromB+g,o.toB+g)).toA,d=C(t,o.fromA,Math.min(o.fromA-n,5))),m=o.fromA-d,g=u-o.toA):!m&&!g&&(p=o.fromA-(h=function(e,t,r){for(let n=t,i=t-r;;){let r=n?e.charCodeAt(n-1):10;if(10==r)return n;if(--n<i||32!=r&&9!=r)return t}}(t,o.fromA,c)))&&t.slice(h,o.fromA)==b.slice(w-p,w)&&(o=e[i]=new l(h,h+s,o.fromB-p,o.toB-p))}(m||g)&&(o=e[i]=new l(o.fromA-m,o.toA+g,o.fromB-m,o.toB+g)),n=o.toA}}return b(e,3),e}(O(e,t,r),e,t)}let L=o.r$.define({combine:e=>e[0]}),E=o.Py.define(),R=o.QQ.define({create:e=>null,update(e,t){for(let r of t.effects)r.is(E)&&(e=r.value);return e}});class S{constructor(e,t,r,n,i){this.changes=e,this.fromA=t,this.toA=r,this.fromB=n,this.toB=i}offset(e,t){return e||t?new S(this.changes,this.fromA+e,this.toA+e,this.fromB+t,this.toB+t):this}get endA(){return Math.max(this.fromA,this.toA-1)}get endB(){return Math.max(this.fromB,this.toB-1)}static build(e,t,r){return _(D(e.toString(),t.toString(),r),e,t,0,0)}static updateA(e,t,r,n,i){return j(V(e,n,!0,r.length),e,t,r,i)}static updateB(e,t,r,n,i){return j(V(e,n,!1,t.length),e,t,r,i)}}function T(e,t,r,n){let i=r.lineAt(e),o=n.lineAt(t);return i.to==e&&o.to==t&&e<r.length&&t<n.length?[e+1,t+1]:[i.from,o.from]}function N(e,t,r,n){let i=r.lineAt(e),o=n.lineAt(t);return i.from==e&&o.from==t?[e,t]:[i.to+1,o.to+1]}function _(e,t,r,n,i){let o=[];for(let s=0;s<e.length;s++){let l=e[s],[f,a]=T(l.fromA+n,l.fromB+i,t,r),[c,h]=N(l.toA+n,l.toB+i,t,r),d=[l.offset(-f+n,-a+i)];for(;s<e.length-1;){let o=e[s+1],[l,u]=T(o.fromA+n,o.fromB+i,t,r);if(l>c+1&&u>h+1)break;d.push(o.offset(-f+n,-a+i)),[c,h]=N(o.toA+n,o.toB+i,t,r),s++}o.push(new S(d,f,Math.max(f,c),a,Math.max(a,h)))}return o}function G(e,t,r,n){let i=0,o=e.length;for(;;){if(i==o){let n=0,o=0;i&&({toA:n,toB:o}=e[i-1]);let s=t-(r?n:o);return[n+s,o+s]}let s=i+o>>1,l=e[s],[f,a]=r?[l.fromA,l.toA]:[l.fromB,l.toB];if(f>t)o=s;else{if(!(a<=t))return n?[l.fromA,l.fromB]:[l.toA,l.toB];i=s+1}}}function V(e,t,r,n){let i=[];return t.iterChangedRanges((o,s,l,f)=>{let a=0,c=r?t.length:n,h=0,d=r?n:t.length;o>1e3&&([a,h]=G(e,o-1e3,r,!0)),s<t.length-1e3&&([c,d]=G(e,s+1e3,r,!1));let u=f-l-(s-o),m,[g,p]=r?[u,0]:[0,u];i.length&&(m=i[i.length-1]).toA>=a?i[i.length-1]={fromA:m.fromA,fromB:m.fromB,toA:c,toB:d,diffA:m.diffA+g,diffB:m.diffB+p}:i.push({fromA:a,toA:c,fromB:h,toB:d,diffA:g,diffB:p})}),i}function j(e,t,r,n,i){if(!e.length)return t;let o=[];for(let s=0,l=0,f=0,a=0;;s++){let c=s==e.length?null:e[s],h=c?c.fromA+l:r.length,d=c?c.fromB+f:n.length;for(;a<t.length;){let e=t[a];if(e.toA+l>h||e.toB+f>d)break;o.push(e.offset(l,f)),a++}if(!c)break;let u=c.toA+l+c.diffA,m=c.toB+f+c.diffB;for(let e of _(D(r.sliceString(h,u),n.sliceString(d,m),i),r,n,h,d))o.push(e);for(l+=c.diffA,f+=c.diffB;a<t.length;){let e=t[a];if(e.fromA+l>u&&e.fromB+f>m)break;a++}}return o}let I=i.lg.fromClass(class{constructor(e){({deco:this.deco,gutter:this.gutter}=X(e))}update(e){var t,r,n,i;(e.docChanged||e.viewportChanged||(t=e.startState,r=e.state,t.field(R,!1)!=r.field(R,!1))||(n=e.startState,i=e.state,n.facet(L)!=i.facet(L)))&&({deco:this.deco,gutter:this.gutter}=X(e.view))}},{decorations:e=>e.deco}),P=o.Wl.low((0,i.v5)({class:"cm-changeGutter",markers:e=>{var t;return(null===(t=e.plugin(I))||void 0===t?void 0:t.gutter)||o.Xs.empty}})),Q=i.p.line({class:"cm-changedLine"}),q=i.p.mark({class:"cm-changedText"}),H=i.p.mark({tagName:"ins",class:"cm-insertedLine"}),U=i.p.mark({tagName:"del",class:"cm-deletedLine"}),F=new class extends i.SJ{constructor(){super(...arguments),this.elementClass="cm-changedLineGutter"}};function X(e){let t=e.state.field(R),{side:r,highlightChanges:n,markGutter:i}=e.state.facet(L),s="a"==r,l=new o.f_,f=i?new o.f_:null,{from:a,to:c}=e.viewport;for(let r of t){if((s?r.fromA:r.fromB)>=c)break;(s?r.toA:r.toB)>a&&function(e,t,r,n,i,o){let s=r?e.fromA:e.fromB,l=r?e.toA:e.toB,f=0;if(s!=l){i.add(s,s,Q),i.add(s,l,r?U:H),o&&o.add(s,s,F);for(let a=t.iterRange(s,l-1),c=s;!a.next().done;){if(a.lineBreak){c++,i.add(c,c,Q),o&&o.add(c,c,F);continue}let t=c+a.value.length;if(n)for(;f<e.changes.length;){let n=e.changes[f],o=s+(r?n.fromA:n.fromB),l=s+(r?n.toA:n.toB),a=Math.max(c,o),h=Math.min(t,l);if(a<h&&i.add(a,h,q),l<t)f++;else break}c=t}}}(r,e.state.doc,s,n,l,f)}return{deco:l.finish(),gutter:f&&f.finish()}}class Y extends i.l9{constructor(e){super(),this.height=e}eq(e){return this.height==e.height}toDOM(){let e=document.createElement("div");return e.className="cm-mergeSpacer",e.style.height=this.height+"px",e}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}let z=o.Py.define({map:(e,t)=>e.map(t)}),W=o.QQ.define({create:()=>i.p.none,update:(e,t)=>{for(let e of t.effects)if(e.is(z))return e.value;return e.map(t.changes)},provide:e=>i.tk.decorations.from(e)}),$=o.Py.define({map:(e,t)=>t.mapPos(e)});class J extends i.l9{constructor(e){super(),this.lines=e}eq(e){return this.lines==e.lines}toDOM(e){let t=document.createElement("div");return t.className="cm-collapsedLines",t.textContent="⦚ "+e.state.phrase("$ unchanged lines",this.lines)+" ⦚",t.addEventListener("click",t=>{let r=e.posAtDOM(t.target);e.dispatch({effects:$.of(r)});let{side:n,sibling:i}=e.state.facet(L);i&&i().dispatch({effects:$.of(function(e,t,r){let n=0,i=0;for(let o=0;;o++){let s=o<t.length?t[o]:null;if(!s||(r?s.fromA:s.fromB)>=e)return i+(e-n);[n,i]=r?[s.toA,s.toB]:[s.toB,s.toA]}}(r,e.state.field(R),"a"==n))})}),t}ignoreEvent(e){return e instanceof MouseEvent}get estimatedHeight(){return 27}}let K=o.QQ.define({create:e=>i.p.none,update(e,t){for(let r of(e=e.map(t.changes),t.effects))r.is($)&&(e=e.update({filter:e=>e!=r.value}));return e},provide:e=>i.tk.decorations.from(e)});function Z({margin:e=3,minSize:t=4}){return K.init(r=>(function(e,t,r){let n=new o.f_,s="a"==e.facet(L).side,l=e.field(R),f=1;for(let o=0;;o++){let a=o<l.length?l[o]:null,c=o?f+t:1,h=a?e.doc.lineAt(s?a.fromA:a.fromB).number-1-t:e.doc.lines,d=h-c+1;if(d>=r&&n.add(e.doc.line(c).from,e.doc.line(h).to,i.p.replace({widget:new J(d),block:!0})),!a)break;f=e.doc.lineAt(Math.min(e.doc.length,s?a.toA:a.toB)).number}return n.finish()})(r,e,t))}let ee=i.tk.styleModule.of(new s.V({".cm-mergeView":{overflowY:"auto"},".cm-mergeViewEditors":{display:"flex",alignItems:"stretch"},".cm-mergeViewEditor":{flexGrow:1,flexBasis:0,overflow:"hidden"},".cm-merge-revert":{width:"1.6em",flexGrow:0,flexShrink:0,position:"relative"},".cm-merge-revert button":{position:"absolute",display:"block",width:"100%",boxSizing:"border-box",textAlign:"center",background:"none",border:"none",font:"inherit",cursor:"pointer"}})),et=i.tk.baseTheme({".cm-mergeView & .cm-scroller, .cm-mergeView &":{height:"auto !important",overflowY:"visible !important"},"&.cm-merge-a .cm-changedLine, .cm-deletedChunk":{backgroundColor:"rgba(160, 128, 100, .08)"},"&.cm-merge-b .cm-changedLine":{backgroundColor:"rgba(100, 160, 128, .08)"},"&light.cm-merge-a .cm-changedText, &light .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ee443366, #ee443366) bottom/100% 2px no-repeat"},"&dark.cm-merge-a .cm-changedText, &dark .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ffaa9966, #ffaa9966) bottom/100% 2px no-repeat"},"&light.cm-merge-b .cm-changedText":{background:"linear-gradient(#22bb2266, #22bb2266) bottom/100% 2px no-repeat"},"&dark.cm-merge-b .cm-changedText":{background:"linear-gradient(#88ff8866, #88ff8866) bottom/100% 2px no-repeat"},".cm-insertedLine, .cm-deletedLine":{textDecoration:"none"},".cm-deletedChunk":{paddingLeft:"6px","& .cm-chunkButtons":{position:"absolute",insetInlineEnd:"5px"},"& button":{border:"none",cursor:"pointer",color:"white",margin:"0 2px",borderRadius:"3px","&[name=accept]":{background:"#2a2"},"&[name=reject]":{background:"#d43"}}},".cm-collapsedLines":{padding:"5px 5px 5px 10px",cursor:"pointer"},"&light .cm-collapsedLines":{color:"#444",background:"linear-gradient(to bottom, transparent 0, #f3f3f3 30%, #f3f3f3 70%, transparent 100%)"},"&dark .cm-collapsedLines":{color:"#ddd",background:"linear-gradient(to bottom, transparent 0, #222 30%, #222 70%, transparent 100%)"},".cm-changeGutter":{width:"3px",paddingLeft:"1px"},"&light.cm-merge-a .cm-changedLineGutter, &light .cm-deletedLineGutter":{background:"#e43"},"&dark.cm-merge-a .cm-changedLineGutter, &dark .cm-deletedLineGutter":{background:"#fa9"},"&light.cm-merge-b .cm-changedLineGutter":{background:"#2b2"},"&dark.cm-merge-b .cm-changedLineGutter":{background:"#8f8"}}),er=new o.F6,en=new o.F6;class ei{constructor(e){this.revertDOM=null,this.revertToA=!1,this.revertToLeft=!1,this.measuring=-1,this.diffConf=e.diffConfig;let t=[o.Wl.low(I),et,ee,W,i.tk.updateListener.of(e=>{this.measuring<0&&(e.heightChanged||e.viewportChanged)&&!e.transactions.some(e=>e.effects.some(e=>e.is(z)))&&this.measure()})],r=[L.of({side:"a",sibling:()=>this.b,highlightChanges:!1!==e.highlightChanges,markGutter:!1!==e.gutter})];!1!==e.gutter&&r.push(P);let n=o.yy.create({doc:e.a.doc,selection:e.a.selection,extensions:[e.a.extensions||[],i.tk.editorAttributes.of({class:"cm-merge-a"}),en.of(r),t]}),s=[L.of({side:"b",sibling:()=>this.a,highlightChanges:!1!==e.highlightChanges,markGutter:!1!==e.gutter})];!1!==e.gutter&&s.push(P);let l=o.yy.create({doc:e.b.doc,selection:e.b.selection,extensions:[e.b.extensions||[],i.tk.editorAttributes.of({class:"cm-merge-b"}),en.of(s),t]});this.chunks=S.build(n.doc,l.doc,this.diffConf);let f=[R.init(()=>this.chunks),er.of(e.collapseUnchanged?Z(e.collapseUnchanged):[])];n=n.update({effects:o.Py.appendConfig.of(f)}).state,l=l.update({effects:o.Py.appendConfig.of(f)}).state,this.dom=document.createElement("div"),this.dom.className="cm-mergeView",this.editorDOM=this.dom.appendChild(document.createElement("div")),this.editorDOM.className="cm-mergeViewEditors";let a=e.orientation||"a-b",c=document.createElement("div");c.className="cm-mergeViewEditor";let h=document.createElement("div");h.className="cm-mergeViewEditor",this.editorDOM.appendChild("a-b"==a?c:h),this.editorDOM.appendChild("a-b"==a?h:c),this.a=new i.tk({state:n,parent:c,root:e.root,dispatchTransactions:e=>this.dispatch(e,this.a)}),this.b=new i.tk({state:l,parent:h,root:e.root,dispatchTransactions:e=>this.dispatch(e,this.b)}),this.setupRevertControls(!!e.revertControls,"b-to-a"==e.revertControls,e.renderRevertControl),e.parent&&e.parent.appendChild(this.dom),this.scheduleMeasure()}dispatch(e,t){if(e.some(e=>e.docChanged)){let r=e[e.length-1],n=e.reduce((e,t)=>e.compose(t.changes),o.as.empty(e[0].startState.doc.length));this.chunks=t==this.a?S.updateA(this.chunks,r.newDoc,this.b.state.doc,n,this.diffConf):S.updateB(this.chunks,this.a.state.doc,r.newDoc,n,this.diffConf),t.update([...e,r.state.update({effects:E.of(this.chunks)})]);let i=t==this.a?this.b:this.a;i.update([i.state.update({effects:E.of(this.chunks)})]),this.scheduleMeasure()}else t.update(e)}reconfigure(e){if("diffConfig"in e&&(this.diffConf=e.diffConfig),"orientation"in e){let t="b-a"!=e.orientation;if(t!=(this.editorDOM.firstChild==this.a.dom.parentNode)){let e=this.a.dom.parentNode,r=this.b.dom.parentNode;e.remove(),r.remove(),this.editorDOM.insertBefore(t?e:r,this.editorDOM.firstChild),this.editorDOM.appendChild(t?r:e),this.revertToLeft=!this.revertToLeft,this.revertDOM&&(this.revertDOM.textContent="")}}if("revertControls"in e||"renderRevertControl"in e){let t=!!this.revertDOM,r=this.revertToA,n=this.renderRevert;"revertControls"in e&&(t=!!e.revertControls,r="b-to-a"==e.revertControls),"renderRevertControl"in e&&(n=e.renderRevertControl),this.setupRevertControls(t,r,n)}let t="highlightChanges"in e,r="gutter"in e,n="collapseUnchanged"in e;if(t||r||n){let i=[],o=[];if(t||r){let n=this.a.state.facet(L),s=r?!1!==e.gutter:n.markGutter,l=t?!1!==e.highlightChanges:n.highlightChanges;i.push(en.reconfigure([L.of({side:"a",sibling:()=>this.b,highlightChanges:l,markGutter:s}),s?P:[]])),o.push(en.reconfigure([L.of({side:"b",sibling:()=>this.a,highlightChanges:l,markGutter:s}),s?P:[]]))}if(n){let t=er.reconfigure(e.collapseUnchanged?Z(e.collapseUnchanged):[]);i.push(t),o.push(t)}this.a.dispatch({effects:i}),this.b.dispatch({effects:o})}this.scheduleMeasure()}setupRevertControls(e,t,r){this.revertToA=t,this.revertToLeft=this.revertToA==(this.editorDOM.firstChild==this.a.dom.parentNode),this.renderRevert=r,!e&&this.revertDOM?(this.revertDOM.remove(),this.revertDOM=null):e&&!this.revertDOM?(this.revertDOM=this.editorDOM.insertBefore(document.createElement("div"),this.editorDOM.firstChild.nextSibling),this.revertDOM.addEventListener("mousedown",e=>this.revertClicked(e)),this.revertDOM.className="cm-merge-revert"):this.revertDOM&&(this.revertDOM.textContent="")}scheduleMeasure(){if(this.measuring<0){let e=this.dom.ownerDocument.defaultView||window;this.measuring=e.requestAnimationFrame(()=>{this.measuring=-1,this.measure()})}}measure(){!function(e,t,r){let n=new o.f_,s=new o.f_,l=e.state.field(W).iter(),f=t.state.field(W).iter(),a=0,c=0,h=0,d=0;for(let o=0;;o++){let u=o<r.length?r[o]:null;if(a<(u?u.fromA:e.state.doc.length)){let r=e.lineBlockAt(a).top+h-(t.lineBlockAt(c).top+d);r<-.01?(h-=r,n.add(a,a,i.p.widget({widget:new Y(-r),block:!0,side:-1}))):r>.01&&(d+=r,s.add(c,c,i.p.widget({widget:new Y(r),block:!0,side:-1})))}if(!u)break;for(a=u.toA,c=u.toB;l.value&&l.from<a;)h-=l.value.spec.widget.height,l.next();for(;f.value&&f.from<c;)d-=f.value.spec.widget.height,f.next()}for(;l.value;)h-=l.value.spec.widget.height,l.next();for(;f.value;)d-=f.value.spec.widget.height,f.next();let u=e.contentHeight+h-(t.contentHeight+d);u<.01?n.add(e.state.doc.length,e.state.doc.length,i.p.widget({widget:new Y(-u),block:!0,side:1})):u>.01&&s.add(t.state.doc.length,t.state.doc.length,i.p.widget({widget:new Y(u),block:!0,side:1}));let m=n.finish(),g=s.finish();o.Xs.eq([m],[e.state.field(W)])||e.dispatch({effects:z.of(m)}),o.Xs.eq([g],[t.state.field(W)])||t.dispatch({effects:z.of(g)})}(this.a,this.b,this.chunks),this.revertDOM&&this.updateRevertButtons()}updateRevertButtons(){let e=this.revertDOM,t=e.firstChild,r=this.a.viewport,n=this.b.viewport;for(let i=0;i<this.chunks.length;i++){let o=this.chunks[i];if(o.fromA>r.to||o.fromB>n.to)break;if(o.fromA<r.from||o.fromB<n.from)continue;let s=this.a.lineBlockAt(o.fromA).top+"px";for(;t&&+t.dataset.chunk<i;)t=eo(t);t&&t.dataset.chunk==String(i)?(t.style.top!=s&&(t.style.top=s),t=t.nextSibling):e.insertBefore(this.renderRevertButton(s,i),t)}for(;t;)t=eo(t)}renderRevertButton(e,t){let r;if(this.renderRevert)r=this.renderRevert();else{r=document.createElement("button");let e=this.a.state.phrase("Revert this chunk");r.setAttribute("aria-label",e),r.setAttribute("title",e),r.textContent=this.revertToLeft?"⇜":"⇝"}return r.style.top=e,r.setAttribute("data-chunk",String(t)),r}revertClicked(e){let t=e.target,r;for(;t&&t.parentNode!=this.revertDOM;)t=t.parentNode;if(t&&(r=this.chunks[t.dataset.chunk])){let[t,n,i,o,s,l]=this.revertToA?[this.b,this.a,r.fromB,r.toB,r.fromA,r.toA]:[this.a,this.b,r.fromA,r.toA,r.fromB,r.toB],f=t.state.sliceDoc(i,Math.max(i,o-1));i!=o&&l<=n.state.doc.length&&(f+=t.state.lineBreak),n.dispatch({changes:{from:s,to:Math.min(n.state.doc.length,l),insert:f},userEvent:"revert"}),e.preventDefault()}}destroy(){this.a.destroy(),this.b.destroy(),this.measuring>-1&&(this.dom.ownerDocument.defaultView||window).cancelAnimationFrame(this.measuring),this.dom.remove()}}function eo(e){let t=e.nextSibling;return e.remove(),t}i.l9}}]);
//# sourceMappingURL=3259-69572e57d7d3c42e.js.map