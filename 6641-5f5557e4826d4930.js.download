!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="5df945d7-c3c6-48dc-9fd4-0026dd5f8bc1",e._sentryDebugIdIdentifier="sentry-dbid-5df945d7-c3c6-48dc-9fd4-0026dd5f8bc1")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"ec45b404"},(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6641],{69977:function(e,t,n){"use strict";n.d(t,{rc:function(){return f},he:function(){return l}});var r,o,i,a=n(63072),s=n(42516);(r=o||(o={})).Standard="standard",r.Compute_2cpu_2ram="compute_2cpu_2ram",r.Compute_4cpu_8ram="compute_4cpu_8ram",r.Compute_8cpu_16ram="compute_8cpu_16ram",r.Compute_16cpu_32ram="compute_16cpu_32ram",r.Compute_32cpu_64ram="compute_32cpu_64ram",i={},(0,s._)(i,"standard","0.5 vCPU, 0.5 GiB RAM"),(0,s._)(i,"compute_2cpu_2ram","2 vCPU, 2 GiB RAM"),(0,s._)(i,"compute_4cpu_8ram","4 vCPU, 8 GiB RAM"),(0,s._)(i,"compute_8cpu_16ram","8 vCPU, 16 GiB RAM"),(0,s._)(i,"compute_16cpu_32ram","16 vCPU, 32 GiB RAM"),(0,s._)(i,"compute_32cpu_64ram","32 vCPU, 64 GiB RAM");var c=n(14224),u=n(91620).lW;function l(e){var t=e.split(".");if(4!==t.length)throw Error("Invalid token: should have exactly 4 parts: "+e);for(var n=t[2].replace(/-/g,"+").replace(/_/g,"/");n.length%4;)n+="=";var r=window.atob(n);if(r.length<64)throw Error("Invalid token: signed part is too short: "+r.length);var o=r.substring(0,r.length-64);return a.api.token.ReplToken.decode(new u(o,"base64"))}function f(e){return e.dotdevHostname.includes(":8081")?"http://".concat(e.dotdevHostname):"https://".concat(e.dotdevHostname)}c.env.PROXY_SUFFIX,c.env.PROXY_FIREWALL_SUFFIX},25172:function(e,t,n){"use strict";n.d(t,{d:function(){return u},u:function(){return s}});var r=n(27387),o=n(66626),i=n(96583),a=n(50959);function s(){return c.apply(this,arguments)}function c(){return(c=(0,r._)(function(){return(0,i.Jh)(this,function(e){return"undefined"!=typeof document&&document.hidden?[2,new Promise(function(e){var t=function(){document.hidden||(document.removeEventListener("visibilitychange",t),e())};document.addEventListener("visibilitychange",t)})]:[2]})})).apply(this,arguments)}function u(){var e=(0,o._)((0,a.useState)(!1),2),t=e[0],n=e[1];return(0,a.useEffect)(function(){var e=function(){n(!document.hidden)};return document.addEventListener("visibilitychange",e),e(),function(){document.removeEventListener("visibilitychange",e)}},[]),t}},45098:function(e,t,n){"use strict";n.d(t,{U:function(){return a},b:function(){return s}});var r=n(3341),o=n.n(r),i=n(50959);function a(e){var t=e.repl,n=e.currentUser;return{asViewer:e.asViewer,repl:{__typename:"Repl",authorizations:t.authorizations,id:t.id,language:t.language,slug:t.slug},currentUser:n?{__typename:"CurrentUser",id:n.id,username:n.username,isSubscribed:n.isSubscribed,roles:n.roles}:void 0}}function s(e){var t=e?a(e):null,n=(0,i.useRef)(t);return o()(t,n.current)||(n.current=t),n.current}},61262:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var r=n(27387),o=n(41733),i=n(30509),a=n(96583),s=n(28690),c=n(36556),u=n(38597),l=n(29139),f=n(85421),d=n.n(f),h=n(74725),p=!!n(14224).env.CAPTCHA_EMBEDS;function v(e){return g.apply(this,arguments)}function g(){return(g=(0,r._)(function(e){var t,n,r,f,g,m,y,C,w,E,b;return(0,a.Jh)(this,function(a){switch(a.label){case 0:if(t=e.replId,n=e.isLoggedIn,r=e.overrideClusterMetadata,f=e.pid2Version,g=e.asViewer,m=e.retry,!l.l)throw Error("Expected apollo client");if(y=!!(d().query.lite||d().query.embed),C={url:"/data/repls/".concat(t,"/get_connection_metadata"),overrideClusterMetadata:r,pid2Version:f,clientVersion:"ec45b404",hCaptchaSiteKey:u.wE,isEmbed:y,retry:m||0,asViewer:g},n||y&&!p)return[3,8];a.label=1;case 1:a.trys.push([1,7,,8]),a.label=2;case 2:return a.trys.push([2,4,,6]),[4,(0,s.Uj)({action:"genReplToken"})];case 3:return E=a.sent(),[3,6];case 4:return a.sent(),[4,(0,u.ZP)()];case 5:return w=a.sent(),[3,6];case 6:return[2,(0,h.Z)((0,i._)((0,o._)({},C),{captcha:w,recaptchaToken:E}))];case 7:return b=a.sent(),c.kg.error("Goval connection failure",{errorMessage:b&&b.message||"unidentified failure",replid:t,reason:"captcha",context:"services"}),[2,v({replId:t,overrideClusterMetadata:r,retry:(m||0)+1,isLoggedIn:n,asViewer:g})];case 8:return[2,(0,h.Z)(C)]}})})).apply(this,arguments)}},46547:function(e,t,n){"use strict";n.d(t,{Z:function(){return u},t:function(){return c}});var r=n(27387),o=n(96583),i=n(75958);n(45005);var a=n(49500);function s(){return(s=(0,r._)(function(){return(0,o.Jh)(this,function(e){return i.Z.get("gurl")?(a.log("Getting gurl from localstorage"),[2,i.Z.get("gurl")]):[2,null]})})).apply(this,arguments)}function c(e){var t=function(e){try{t=new URL(e)}catch(e){return a.log("failed to parse gurl"),a.error(e),null}var t,n={secure:!1,port:""+t.port,host:t.hostname};return"wss:"===t.protocol?n.secure=!0:"ws:"!==t.protocol&&a.log(e,"Expected gurl protocol to be ws or wss, assuming insecure connection"),n.port||(n.port=n.secure?"443":"80"),n}(e);if(!t)return null;var n=t.secure,r=t.host,o=t.port;return"repl.it"===r||"gp-v2.replit.com"===r||"gp-v2.firewalledreplit.com"===r||"eval.replit.com"===r?null:{id:"development",gurl:"ws".concat(n?"s":"","://").concat(r,":").concat(o),conmanURL:"http".concat(n?"s":"","://").concat(r,":").concat(o),proxy:"http".concat(n?"s":"","://").concat(r.replace("eval","proxy"),":").concat(o)}}function u(){return l.apply(this,arguments)}function l(){return(l=(0,r._)(function(){var e;return(0,o.Jh)(this,function(t){switch(t.label){case 0:return[4,function(){return s.apply(this,arguments)}()];case 1:if(!(e=t.sent()))return[2,null];return[2,c(e)]}})})).apply(this,arguments)}},95420:function(e,t,n){"use strict";n.d(t,{C:function(){return c},D:function(){return s}});var r=n(21262),o=n(71440);function i(){var e=(0,r._)(["\n  fragment CrosisContextCurrentUser on CurrentUser {\n    id\n    username\n    isSubscribed\n    roles {\n      id\n      name\n    }\n  }\n"]);return i=function(){return e},e}function a(){var e=(0,r._)(['\n  fragment CrosisContextRepl on Repl {\n    id\n    language\n    slug\n    user {\n      id\n      username\n    }\n    authorizations {\n      editFileContents {\n        isAuthorized\n      }\n    }\n    flagPid2: gateOnOwner(feature: "flag-pid2")\n  }\n']);return a=function(){return e},e}var s=(0,o.Ps)(i()),c=(0,o.Ps)(a())},2993:function(e,t,n){"use strict";n.d(t,{ZP:function(){return v},em:function(){return p.e}});var r=n(27387),o=n(96583),i=n(36556),a=n(69977),s=n(25172),c=n(46547),u=n(85421),l=n.n(u),f=n(9797),d=n(66810),h=n(61262),p=n(17165);function v(e){var t,n,u=e.connCtx,p=e.onUnrecoverableError,v=e.onFirewallDenied,g=e.ctx,m={register:function(e,r){return n(),window.addEventListener("online",e),window.addEventListener("offline",r),t=function(){window.removeEventListener("online",e),window.removeEventListener("offline",r)},n},unregister:n=function(){t&&(t(),t=void 0)}},y=m.register,C=m.unregister,w=void 0;return u&&(w=u.muxer.getCrosisWebSocketClass()),(0,d.ZP)({fetchConnectionMetadata:u?u.getCachedConnectionMetadata:h.Z,getOverrideClusterMetadata:c.Z,getDotdevUrl:a.rc,logger:i.kg,onUnrecoverableError:p,onFirewallDenied:v,performance:window.performance,preFetchConnectionMetadata:(0,r._)(function(){var e;return(0,o.Jh)(this,function(t){switch(t.label){case 0:if(window.performance.clearMarks(f.Iy.fetchConnectionMetadataPageInvisibleStart),window.performance.clearMarks(f.Iy.fetchConnectionMetadataPageInvisibleEnd),e=i.kg.timeStart(),window.performance.mark(f.Iy.fetchConnectionMetadataPageInvisibleStart),!("/migrateReplToNix"!==l().pathname))return[3,2];return[4,(0,s.u)()];case 1:t.sent(),t.label=2;case 2:window.performance.mark(f.Iy.fetchConnectionMetadataPageInvisibleEnd),e("page visible fetch connection metadata"),t.label=3;case 3:return[2]}})}),registerReconnectionMonitor:y,unregisterReconnectionMonitor:C,crosisWebSocketClass:w,traceCtx:g})}},52399:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(12285),o=n(4384),i=n(91620).lW,a=function(){function e(t,n){if((0,r._)(this,e),this.asEncoding={},this.asBuffer=null,n&&"string"==typeof t)this.asEncoding[n]=t;else if(null==t)this.asBuffer=i.alloc(0);else if(t instanceof i)this.asBuffer=t;else if("string"==typeof t)this.asEncoding.utf8=t;else if(t instanceof ArrayBuffer)this.asBuffer=i.from(t);else{if(t instanceof e)return t;t instanceof Uint8Array?this.asBuffer=i.from(t):"object"==typeof t&&"object"==typeof t.asEncoding&&null!==t.asEncoding&&(t.asBuffer instanceof i||null===t.asBuffer)&&(this.asBuffer=t.asBuffer||null,"string"==typeof t.asEncoding.base64&&(this.asEncoding={base64:t.asEncoding.base64}),"string"==typeof t.asEncoding.utf8&&(this.asEncoding={utf8:t.asEncoding.utf8}))}}var t=e.prototype;return t.toString=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";if(void 0!==this.asEncoding[e])return this.asEncoding[e];var t=this.toBuffer().toString(e);return this.asEncoding[e]=t,t},t.toJSON=function(){return{asEncoding:{base64:this.toString("base64")},asBuffer:null}},t.toBuffer=function(){if(this.asBuffer)return this.asBuffer;for(var e in this.asEncoding){var t=this.asEncoding[e];if("string"==typeof t){var n=i.from(t,e);return this.asBuffer=n,n}}return this.asBuffer=i.alloc(0),this.asBuffer},e.from=function(t,n){return new e(t,n)},e.isBuffer=function(t){return t instanceof e},(0,o._)(e,[{key:"length",get:function(){return void 0!==this.asEncoding.utf8?this.asEncoding.utf8.length:this.toBuffer().length}}]),e}()},39171:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(63257),o=n(56391);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{wait:0},n=null,i=null,a=null,s=null;if(t.wait<0)throw Error("wait must be 0 or more");if(t.maxWait){if(t.maxWait<0)throw Error("maxWait must be 0 or more");if(t.maxWait<t.wait)throw Error("maxWait must be higher than wait")}function c(){i&&clearTimeout(i),i=null,s=null,n=null,a=null}function u(){if(!n||!i)throw Error("Expected to call debounced function once before flushing");var t=n,o=s;return c(),e.apply(void 0,(0,r._)(o)).then(function(e){return t.resolve(e),e}).catch(function(e){throw t.reject(e),e})}return Object.assign(function(){for(var e=arguments.length,r=Array(e),c=0;c<e;c++)r[c]=arguments[c];if(n){if(!i)throw Error("Did not expect to have deferred and no timeout");clearTimeout(i)}else n=(0,o.Z)(),a=Date.now();return s=r,i=setTimeout(function(){u()},function(){if(!t.maxWait)return t.wait;if(!a)throw Error("Expected scheduledAt to be a set when getting wait");var e=Date.now()-a;return Math.min(t.maxWait-e,t.wait)}()),n.promise},{isScheduled:function(){return!!(n&&i)},cancel:function(){if(!i||!n)throw Error("Expected to call debounced function once before cancelling");var e=n;c(),e.reject(Error("Debounced function cancelled"))},flush:u})}},22897:function(e,t,n){"use strict";n.d(t,{F:function(){return i}});var r=n(2761),o=n(80403);function i(e,t){var n=[],i=!0,a=!1,s=void 0;try{for(var c,u=(0,r.Hg)(e.toString(),t.toString())[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var l=c.value,f=l.fromA,d=l.fromB,h=l.toA,p=l.toB;f===h&&n.push({from:f,insert:t.slice(d,p)}),d===p&&n.push({from:f,to:h,insert:""}),f!==h&&d!==p&&n.push({from:f,to:h,insert:t.slice(d,p)})}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return o.as.of(n,e.length)}},12663:function(e,t,n){"use strict";n.d(t,{JV:function(){return i},ZP:function(){return o}});var r=n(72100);function o(){return new r.EventEmitter}function i(e,t){return function(n){return e.on(t,n),function(){e.off(t,n)}}}},56391:function(e,t,n){"use strict";function r(){var e,t,n={promise:new Promise(function(n,r){e=n,t=r}),resolve:function(t){n.isFulfilled=!0,e(t)},reject:function(e){n.isFulfilled=!0,t(e)},isFulfilled:!1};return n}n.d(t,{Z:function(){return r}})},74275:function(e,t,n){"use strict";function r(e){var t=e.toString();return t.endsWith("/")?t.slice(0,-1):t}function o(e){if(e.startsWith("/"))throw Error("Absolute paths are not allowed, got: ".concat(e));if(e.startsWith("~/"))throw Error("Tilde paths are not allowed, got: ".concat(e));return"."===e||"./"===e||""===e?".":e.startsWith("./")?r(e.slice(2)):r(e)}function i(e){var t;return null!==(t=r(e.toString()).split("/").pop())&&void 0!==t?t:""}function a(e){if(c(e))throw Error("Cannot get parent path of root path");return o(e.toString().split("/").slice(0,-1).join("/"))}function s(e){for(var t=e.toString().split("/"),n=["."],r=0;r<t.length;r++){var i=t.slice(0,r+1).join("/");n.push(o(i))}return n}function c(e){return"."===e}function u(e,t){if(e===t)return!1;if(c(e))return!0;if(c(t))return!1;var n=e.toString();return t.toString().startsWith(n+"/")}function l(e,t){if(!u(e,t))return!1;if(c(e))return!0;var n=e.toString();return t.toString().split("/").length-n.split("/").length==1}function f(e,t){return c(e)?o(t.toString()):o("".concat(e,"/").concat(t))}function d(e,t,n){if(!u(e,n))throw Error("Path is not a descendant of old ancestor path");if(c(e))return f(t,i(n));var r=n.toString();if(c(t))return o(r.replace("".concat(e.toString(),"/"),""));var a=e.toString(),s=t.toString();return o(r.replace(a+"/",s+"/"))}n.d(t,{Bf:function(){return i},C_:function(){return c},DH:function(){return a},K1:function(){return f},MO:function(){return l},S1:function(){return o},X2:function(){return u},eB:function(){return d},nV:function(){return s}})},90005:function(e,t,n){"use strict";n.d(t,{Ci:function(){return i},cJ:function(){return a},hD:function(){return s}});var r=n(95938),o=/^(\.env$|\.npm$|\.npm\/|__pycache__|\.cache|\.breakpoints|\.git$|\.git\/|\.upm$|\.upm\/|node_modules$|node_modules\/|_test_runner|\.local)/;function i(e){return o.test(e)}function a(e){return e.startsWith(".")&&!r.ZP.includes(e)}var s=[".git",".upm",".cache","__pycache__","node_modules","venv",".pythonlibs",".local"]},12605:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(14224);function o(){var e;return(null===(e=window)||void 0===e?void 0:e.location.hostname)==="firewalledreplit.com"||"1"===r.env.FIREWALL_MODE}},367:function(e,t,n){"use strict";n.d(t,{DW:function(){return p},GK:function(){return l},Rg:function(){return m},T0:function(){return c},eh:function(){return g},nO:function(){return d}});var r=n(27387),o=n(96583),i=n(85633),a=n(51305),s=n(18293),c="repl.it-web",u=i.g.getTracer(c);function l(e,t){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function(e,t){return(0,o.Jh)(this,function(n){switch(n.label){case 0:return[4,d(a.D.active(),e,t)];case 1:return[2,n.sent()]}})})).apply(this,arguments)}function d(e,t,n){return h.apply(this,arguments)}function h(){return(h=(0,r._)(function(e,t,n){var r,a;return(0,o.Jh)(this,function(o){switch(o.label){case 0:r=u.startSpan(t,void 0,e),a=i.g.setSpan(e,r),o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,n(a)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return r.end(),[7];case 5:return[2]}})})).apply(this,arguments)}function p(e,t,n){return v.apply(this,arguments)}function v(){return(v=(0,r._)(function(e,t,n){var r,a;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(void 0!==e)return[3,2];return[4,n()];case 1:return[2,o.sent()];case 2:r=u.startSpan(t,void 0,e),a=i.g.setSpan(e,r),o.label=3;case 3:return o.trys.push([3,5,6,7]),[4,n(a,r)];case 4:return[2,o.sent()];case 5:throw o.sent();case 6:return r.end(),[7];case 7:return[2]}})})).apply(this,arguments)}function g(e,t){var n=u.startSpan(t,void 0,e),r=i.g.setSpan(e,n);return{span:n,childCtx:r}}function m(e){var t={};return new s.jf().inject(e,t,{set:function(e,t,n){e[t]=n}}),t}},74725:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(27387),o=n(41733),i=n(98924),a=n(96583),s=n(38931),c=n(45005),u=n.n(c),l=n(23689),f=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;function d(e){return h.apply(this,arguments)}function h(){return(h=(0,r._)(function(e){var t,n,r,c,d,h,p,v,g;return(0,a.Jh)(this,function(a){switch(a.label){case 0:t=e.url,n=(0,i._)(e,["url"]),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,u()(t,{credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},method:"post",body:JSON.stringify(n)})];case 2:return r=a.sent(),[3,4];case 3:throw(c=a.sent()).statusCode||(c.statusCode=504),c;case 4:if(h=(d=r.headers.get("content-type"))&&d.includes("application/json"),r.ok)return[3,9];if(!h)return[3,6];return[4,r.json()];case 5:return p=a.sent().message,[3,8];case 6:return[4,r.text()];case 7:p=a.sent(),a.label=8;case 8:throw new l.Z(p||r.statusText).setExtras((0,o._)({url:t},n)).setStatusCode(r.status);case 9:if(h)return[3,11];return[4,r.text()];case 10:throw v=a.sent(),new l.Z("Expected JSON response for connection metadata").setExtras((0,o._)({contentType:d,statusText:r.statusText,response:v,url:t},n)).setStatusCode(r.status);case 11:return[4,r.json()];case 12:var m;if(!((m=g=a.sent())&&"object"==typeof m&&"token"in m&&"string"==typeof m.token&&"gurl"in m&&"string"==typeof m.gurl&&"conmanURL"in m&&"string"==typeof m.conmanURL&&("dotdevHostname"in m&&"string"==typeof m.dotdevHostname||(s.kg.error("Lore returned an incomplete metadata",{res:m}),m.dotdevHostname=""),1)))throw new l.Z("Invalid format for connection metadata response").setExtras((0,o._)({connectionMetadata:g,url:t},n));if(!(g.token.startsWith("v2.public.")||f.test(g.token)))throw new l.Z("Expected token to be PASETO- or base64-encoded").setExtras((0,o._)({connectionMetadata:g,url:t},n));return[2,g]}})})).apply(this,arguments)}},66810:function(e,t,n){"use strict";n.d(t,{em:function(){return v.e},Y8:function(){return b},ZP:function(){return D}});var r=n(27387),o=n(41733),i=n(30509),a=n(98924),s=n(63257),c=n(96583),u=n(89890),l=n.n(u),f=n(82776),d=n(43182);function h(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)(function(e){var t,n,r,o;return(0,c.Jh)(this,function(i){return t=e.client,n=e.args,r=e.env,o=e.noUserEnv,[2,new Promise(function(e){var i=t.openChannel({service:"exec"},function(t){var a=t.channel,s="";a.onCommand(function(e){e.output&&(s+=e.output)}),a.request({exec:{args:n,env:r,noUserEnv:null!=o&&o}}).then(function(t){if(t.channelClosed){e({error:"Channel closed",output:s||null});return}if("open"===a.status&&i(),t.error){e({error:t.error,output:s||null});return}e({output:s,error:null})})})})]})})).apply(this,arguments)}var v=n(17165),g=n(12663),m=n(23689),y=n(12605),C=n(6949),w=n(367),E=n(49500),b=5900,S=.1>=Math.random();function _(e){return Math.min(1e3*Math.pow(2,e),3e4)+Math.floor(500*Math.random())}function D(e){var t,n=e.fetchConnectionMetadata,u=e.getOverrideClusterMetadata,p=e.getDotdevUrl,D=e.logger,k=e.onFirewallDenied,x=e.onUnrecoverableError,T=e.performance,F=e.preFetchConnectionMetadata,O=e.registerReconnectionMonitor,R=e.unregisterReconnectionMonitor,M=e.crosisTimeout,P=e.crosisWebSocketClass,L=e.traceCtx,A=(0,g.ZP)();A.setMaxListeners(1e3);var N=null,I=new f.KU;I.setUnrecoverableErrorHandler(x),k&&(I.onFirewallDenied=k),I.onDebugLog(function(e){if("breadcrumb"===e.type){t="container:state"===e.message?{containerState:e.data}:"data"in e?e.data:void 0,d.n_({category:"crosisV6",message:e.message,data:t});var t,n={replid:null==N?void 0:N.repl.id,language:null==N?void 0:N.repl.language};switch(e.message){case"timeout:hit":D.error("crosis connect timeout",n);break;case"onUnrecoverableError":var r=(0,o._)({errorMessage:e.data.message},n);D.error("crosis unrecoverable error",r);break;case"status:retrying":var i=e.data,s=i.error,c=(0,a._)(i,["error"]),u=(0,o._)({errorMessage:s.message},n,c);D.error("crosis retrying",u);break;case"status:connecting":case"status:reconnecting":var l=e.message.split(":")[1];D.info("crosis ".concat(l),(0,o._)({},n,"data"in e?e.data:void 0));break;case"websocket:polling fallback":D.info("crosis polling fallback",(0,o._)({},n))}}});var J=window.location.search.includes("debug=1");J&&I.onDebugLog(function(e){"log"===e.type&&E.log("in"===e.log.direction?"-->":"<--",e.log.channel.service,{cmd:e.log.cmd,channel:e.log.channel})});var U=function(e){var t=void 0;if(void 0!==L&&e.service){var n="";"string"==typeof e.service?n=e.service:N&&(n=e.service(N)),n&&(t=(0,w.eh)(L,"container.".concat(n,".openChannel")).span)}return t};return{logger:D,performance:T,onPortOpened:function(e){return A.on(v.z.PORT_OPEN,e),function(){A.removeListener(v.z.PORT_OPEN,e)}},onPortClosed:function(e){return A.on(v.z.PORT_CLOSE,e),function(){A.removeListener(v.z.PORT_CLOSE,e)}},onToast:function(e){return A.on(v.z.TOAST,e),function(){A.removeListener(v.z.TOAST,e)}},onConnectionStateChanged:function(e){return I.onConnectionStateChange(e)},connect:function(e){var t,d,h=this,p=e.context,g=e.fetchConnectionMetadataExtras,w=e.getMinimumRetryDelayMs,k=(0,a._)(e,["context","fetchConnectionMetadataExtras","getMinimumRetryDelayMs"]);I.getConnectionState()!==v.e.DISCONNECTED&&I.close(),N=p,O(function(){I.getConnectionState()===v.e.DISCONNECTED&&h.connect((0,o._)({context:p,fetchConnectionMetadataExtras:g,getMinimumRetryDelayMs:w},k))},function(){I.getConnectionState()!==v.e.DISCONNECTED&&h.close({expectReconnect:!0})});var R=this,L=(t=(0,r._)(function(e){var t,n,r,i,a,s;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if(t=e.chan0,n=e.gurl,r=e.isFirst,"open"!==t.status)return[2];return i=D.timeStart({gurl:n}),a=setTimeout(function(){D.error("ping with no response",{gurl:n}),R.connect((0,o._)({context:p,fetchConnectionMetadataExtras:g,getMinimumRetryDelayMs:w},k))},3e4),[4,t.request({ping:{}})];case 1:if(s=c.sent().channelClosed,clearTimeout(a),s)return[2];return r?i("latency to pid1",{type:"startup"}):S&&i("latency to pid1",{type:"periodic"}),setTimeout(function(){return L({chan0:t,gurl:n,isFirst:!1})},1e3),[2]}})}),function(e){return t.apply(this,arguments)}),U={getNextRetryDelayMs:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return Math.max(_.apply(void 0,(0,s._)(t)),w())},context:p,reuseConnectionMetadata:!0,fetchConnectionMetadata:(d=(0,r._)(function(e){var t,r,a,s,l;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if("function"!=typeof F)return[3,2];return[4,F()];case 1:c.sent(),c.label=2;case 2:if("function"!=typeof u)return[3,4];return[4,u()];case 3:return r=c.sent(),[3,5];case 4:r=null,c.label=5;case 5:if(t=r,e.aborted)return[2,{error:f.gS.Aborted}];a=D.timeStart({hasCustomFetch:!!k.fetchConnectionMetadata}),c.label=6;case 6:if(c.trys.push([6,11,,12]),!k.fetchConnectionMetadata)return[3,8];return[4,k.fetchConnectionMetadata()];case 7:return s=c.sent(),[3,10];case 8:return[4,n((0,o._)({asViewer:p.asViewer,replId:p.repl.id,isLoggedIn:!!p.currentUser,overrideClusterMetadata:t},g))];case 9:s=c.sent(),c.label=10;case 10:return[3,12];case 11:if(l=c.sent(),e.aborted)return[2,{error:f.gS.Aborted}];switch(l&&l.statusCode){case 400:case 401:case 403:throw new C.cb(l.statusCode);case 408:case 409:case 429:case 500:case 502:case 503:case 504:case 526:return D.warn("Retriable error while fetching connection metadata",{statusCode:l.statusCode,originalMessage:l.message}),[2,{error:f.gS.Retriable}]}throw l;case 12:if(e.aborted)return[2,{error:f.gS.Aborted}];return J&&E.log("connecting",s),a("fetched connection metadata"),[2,(0,i._)((0,o._)({},s),{error:null})]}})}),function(e){return d.apply(this,arguments)})};M&&M>0&&(U.timeout=M),P?U.WebSocketClass=P:"undefined"==typeof WebSocket&&(U.WebSocketClass=l()),(0,y.Z)();var B=T.now(),Z=0;I.open(U,function(e){var t,n=e.channel;J&&E.log("connected",{replId:p.repl.id});var r=n.onCommand(function(e){switch(e.body){case"portOpen":if(!e.portOpen)throw Error("portOpen only handles portOpen commands");var t=!!e.portOpen.forwarded,n=e.portOpen,r=n.address,o=n.cmdline,i=n.cgroup,a=n.pid,s=e.portOpen.port||0;if(5901===s)return;A.emit(v.z.PORT_OPEN,{port:s,externalPort:e.portOpen.externalPort,isVnc:s===b,isForwarded:t,address:r,cmdline:o,cgroup:i,pid:a});break;case"portClose":if(!e.portClose)throw Error("portClose only handles portClose commands");var c=e.portClose.port||0,u=e.portClose.address;if(5901===c)return;A.emit(v.z.PORT_CLOSE,{port:c,externalPort:e.portClose.externalPort,isVnc:c===b,address:u});break;case"protocolError":x(new m.Z("goval panic").setExtra("message",null!==(f=null===(l=e.protocolError)||void 0===l?void 0:l.text)&&void 0!==f?f:"protocol error"));break;case"toast":var l,f,d,h=null===(d=e.toast)||void 0===d?void 0:d.text;if(!h)break;A.emit(v.z.TOAST,h)}});L({chan0:n,gurl:null===(t=I.getConnectionMetadata())||void 0===t?void 0:t.gurl,isFirst:!0}),window.v6ws=I.ws;var o=T.now()-B;return D.info("connected to pid1",{time:o,reconnectCount:Z,replid:p.repl.id,language:p.repl.language}),function(e){var t=e.willReconnect;if(r(),!t){N=null;return}B=T.now(),Z++}})},openChannel:function(e,t){var n=U(e);return I.openChannel(e,function(e){var r=e.channel.onCommand(function(e){if("protocolError"===e.body){var t,n;x(new m.Z("goval panic").setExtra("message",null!==(n=null===(t=e.protocolError)||void 0===t?void 0:t.text)&&void 0!==n?n:"protocol error"))}}),o=t(e);return void 0!==n&&n.end(),function(e){o&&o(e),r&&r()}})},getConnectionState:function(){return I.getConnectionState()},exec:(0,r._)(function(){var e,t,n,r=arguments;return(0,c.Jh)(this,function(o){for(t=Array(e=r.length),n=0;n<e;n++)t[n]=r[n];return[2,h({client:I,args:t})]})}),execImmediately:(0,r._)(function(){var e,t,n,r=arguments;return(0,c.Jh)(this,function(o){for(t=Array(e=r.length),n=0;n<e;n++)t[n]=r[n];return[2,h({client:I,args:t,noUserEnv:!0})]})}),execWithEnv:(t=(0,r._)(function(e){var t,n,r,o=arguments;return(0,c.Jh)(this,function(i){for(n=Array((t=o.length)>1?t-1:0),r=1;r<t;r++)n[r-1]=o[r];return[2,h({client:I,args:n,env:e})]})}),function(e){return t.apply(this,arguments)}),close:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{expectReconnect:!1};I.getConnectionState()!==v.e.DISCONNECTED&&I.close(e)},destroy:function(){I.destroy(),A.removeAllListeners(),R()},client:function(){return I},focus:function(){var e=I.getChannel(0);e&&e.send({focused:{}})},getConnectionMetadata:function(){return I.getConnectionMetadata()},getContext:function(){return N},getDotdevUrl:function(){var e=I.getConnectionMetadata();if(!e||I.getConnectionState()!==v.e.CONNECTED)throw Error("Cannot get dot dev url when container is not connected");return p(e)},unrecoverableError:function(e,t){I.destroy(),A.removeAllListeners(),x(t?m.Z.wrap(e).setExtras(t):e)}}}},6949:function(e,t,n){"use strict";n.d(t,{Gs:function(){return o},ZP:function(){return f},cb:function(){return d}});var r,o,i=n(12285),a=n(4955),s=n(66626),c=n(14105),u=n(9670);(r=o||(o={})).NotFound="NotFound",r.NotAllowed="NotAllowed",r.ConcurrentReplLimit="ConcurrentReplLimit",r.FirewallDenied="FirewallDenied",r.LanguageTokenDenied="LanguageTokenDenied",r.RequiresRefresh="RequiresRefresh";var l={"repl not found":"NotFound","not allowed to run at this time":"NotAllowed","language tokens are only for logged out people.":"LanguageTokenDenied","connect to unfirewalled repl from firewall mode":"FirewallDenied","user is required to refresh":"RequiresRefresh"};function f(e){var t=!0,n=!1,r=void 0;try{for(var o,i=Object.entries(l)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=(0,s._)(o.value,2),c=a[0],u=a[1];if(e.message.toLowerCase().includes(c))return u}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return null}var d=function(e){(0,a._)(n,e);var t=(0,u._)(n);function n(e){return(0,i._)(this,n),t.call(this,"user is required to refresh: "+e)}return n}((0,c._)(Error))},17165:function(e,t,n){"use strict";n.d(t,{e:function(){return i.em},z:function(){return o}});var r,o,i=n(82776);(r=o||(o={})).CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",r.PORT_OPEN="PORT_OPEN",r.PORT_CLOSE="PORT_CLOSE",r.TOAST="TOAST"},73372:function(e,t,n){"use strict";n.d(t,{AS:function(){return s},Ql:function(){return o},oh:function(){return a},wL:function(){return i}});var r=n(74275),o=(0,r.S1)("."),i=(0,r.S1)(".env"),a=(0,r.S1)(".lesson"),s=(0,r.S1)(".tutorial")},38938:function(e,t,n){"use strict";n.d(t,{q:function(){return J},Z:function(){return U}});var r=n(27387),o=n(41733),i=n(30509),a=n(78950),s=n(63257),c=n(96583),u=n(80403),l=n(63072),f=n(43182),d=n(38931),h=n(70090),p=n(52399),v=n(39171),g=n(22897),m=n(56391),y=n(74275),C=n(36559),w=n(90005),E=n(4377),b=n(12285),S=n(4955),_=n(9670),D=n(72100),k=n(51228),x=n(86763),T=n.n(x),F=n(57253),O=n(96955);function R(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;switch(s){case F.Df.NotFound:if(e.includes("no such file")||e.includes("file does not exist"))return F.Df.NotFound;break;case F.Df.AlreadyExists:if(e.includes("file exist"))return F.Df.AlreadyExists;break;case F.Df.NotDirectory:if(e.includes("not a directory"))return F.Df.NotDirectory;break;case F.Df.IsDirectory:if(e.includes("is a directory"))return F.Df.IsDirectory;break;case F.Df.InvalidPath:if(e.includes("absolute paths are not supported"))return F.Df.InvalidPath;break;case F.Df.DiskQuotaExceeded:if(e.includes("disk quota exceeded"))return F.Df.DiskQuotaExceeded;break;case F.Df.PermissionDenied:if(e.includes("permission denied"))return F.Df.PermissionDenied;break;case F.Df.FileSystemUnavailable:if(e.includes("input/output error"))return F.Df.FileSystemUnavailable;break;default:(0,O.Z)(s)}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return null}var M=n(6498),P=n(9797),L=n(25150),A=n(23689),N=function(e){(0,S._)(n,e);var t=(0,_._)(n);function n(e,a,s,f,d,v){(0,b._)(this,n),(S=t.call(this)).writeChanges=function(e,t){if(!S.channel&&!S.isReconnecting)throw Error("Trying to send changes before ever coming online");S.isReconnecting&&(S.didEditOffline=!0);var n=(0,M.ed)(e,S.localContent),r=n.op,i=n.docAfter;if(.1>Math.random()){var a=(0,M.f5)(k.type.apply(S.localContent,r)),s=e.apply((0,M.tT)(S.localContent));(a!==s.sliceString(0)||a!==(0,M.f5)(i))&&S.onError("changeset to op mismatch",{originalError:null,changes:e,otContent:a,changeSetContent:s,docAfter:i})}var c=(null==t?void 0:t.author)==="ghostwriter"?{author:l.api.OTPacket.Author.GHOSTWRITER}:{};S.metadata=(0,o._)({},S.metadata,c);try{S.pending=k.type.compose(S.pending,r)}catch(e){throw A.Z.wrap(e).setExtras({op:r,pending:S.pending})}S.localContent=i,0!==S.pending.length?S.emit("fileDirty"):S.commitPromise&&S.emit("commitStart"),S.debounceSend()},S.updateCursors=function(e){S.pendingCursors=e,S.debounceSend()},S.isClean=function(){return S.committedVersion===S.version&&0===S.inflight.length&&0===S.pending.length},S.onError=function(e,t){if(t.originalError){var n="string"==typeof t.originalError?t.originalError:t.originalError.message,r=R(n,[F.Df.NotFound,F.Df.IsDirectory,F.Df.DiskQuotaExceeded,F.Df.InvalidPath,F.Df.PermissionDenied,F.Df.FileSystemUnavailable]);if(r){S.emit("fsError",r,n);return}}S.destroy();var a=Error("OT Error: "+e);S.emit("error",a,(0,i._)((0,o._)({},t),{filePath:S.linkedFile,version:S.version}))},S.sendOp=function(){if(S.channel&&"open"===S.channel.status&&!S.isReconnecting&&!(S.inflight.length>0)){if(0!==S.pending.length){var e=(0,M.gR)(S.pending);S.inflight=S.pending,S.pending=[],S.inflightOpsPromise=S.channel.request({ot:(0,o._)({spookyVersion:S.version,op:e},S.metadata)}),S.metadata={},S.inflightOpsPromise.then(function(t){t.error&&S.onError("error accepting packet",{originalError:t.error,op:e})})}if(0!==S.pendingCursors.length){var t=!0,n=!1,r=void 0;try{for(var i,a=S.flushedCursorIds[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;S.channel.send({otDeleteCursor:{id:s}})}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}S.flushedCursorIds=[];var c=!0,u=!1,l=void 0;try{for(var f,d=S.pendingCursors[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var h=f.value,p=Number(Math.random().toString().split(".")[1]).toString(36);S.flushedCursorIds.push(p),S.channel.send({otNewCursor:(0,o._)({id:p,user:S.user},h)})}}catch(e){u=!0,l=e}finally{try{c||null==d.return||d.return()}finally{if(u)throw l}}S.pendingCursors=[]}}},S.handlePacket=function(e,t){var n=e.op,r=e.version,o=e.crc32,i=t.overrideReconnectingBuffer;if(S.isReconnecting&&!i){S.bufferedReconnectingOps.push({crc32:o,op:n,version:r});return}if(-1===S.version){S.onError("Got packet while version is still -1, expected version to be set in handleStatus",{originalError:null});return}if(S.version++,r!==S.version){var a={originalError:null,expectedVersion:S.version,receivedVersion:r,incomingOp:n};S.logger.error("OT Error: invalid server version",(0,P.P1)({details:a})),S.onError("invalid server version",a);return}try{S.serverContent=k.type.apply(S.serverContent,n)}catch(e){S.onError("unable to apply updated content",{originalError:e,incomingOp:n});return}var s=h.str(S.serverContent)>>>0;if(s!==o){var c={originalError:null,incomingVersion:r,server:o,client:s,incomingOp:n};S.logger.error("OT Error: crc32 mismatch",(0,P.P1)({details:c})),S.onError("crc32 mismatch",c);return}if(S.uncommittedOps.push({version:r,crc32:o,op:n}),S.dataloss&&S.shouldTrackDataLoss&&S.dataloss.storeOp({replId:S.replId,filePath:S.linkedFile.toString(),opType:"latestOp",op:{version:r,crc32:o},logger:S.logger,isReconnecting:S.isReconnecting}),JSON.stringify(n)===JSON.stringify(S.inflight)){S.dataloss&&S.shouldTrackDataLoss&&S.dataloss.storeOp({replId:S.replId,filePath:S.linkedFile.toString(),opType:"latestOwnOp",op:{version:r,crc32:o},logger:S.logger,isReconnecting:S.isReconnecting}),S.debounceCommit(),S.inflight=[],S.inflightOpsPromise=null,S.debounceSend(),S.debounceSend.flush();return}if(S.commitPromise||S.emit("fileDirty"),S.debounceCommit(),S.hasUncommittedMultiplayerOps=!0,S.inflight.length){var u=k.type.transform(S.inflight,n,"right");n=k.type.transform(n,S.inflight,"left"),S.inflight=u}if(S.pending.length){var l=k.type.transform(S.pending,n,"right");n=k.type.transform(n,S.pending,"left"),S.pending=l}var f=(0,M.mt)(n,S.localContent),d=f.changes,p=f.docAfter;if(.1>Math.random()){var v=(0,M.f5)(k.type.apply(S.localContent,n)),g=d.apply((0,M.tT)(S.localContent));(v!==g.sliceString(0)||v!==(0,M.f5)(p))&&S.onError("op to changeset mismatch",{originalError:null,op:n,otContent:v,changeSetContent:g,docAfter:p})}S.localContent=p,S.emit("changes",d)},S.handleNewCursor=function(e){S.emit("cursor",e)},S.handleDeleteCursor=function(e){var t=e.id;S.emit("removeCursor",t)};var g,m,y,C,w,S,_=(0,E._)(S);S.handleStatus=(g=(0,r._)(function(e){var t,n,r,o,i;return(0,c.Jh)(this,function(a){switch(a.label){case 0:if(!_.channel||"open"!==_.channel.status)return[2];if(e.linkedFile){if(null==e.contents)return _.onError("expected status contents, got null or undefined",{originalError:null}),[2];if(null==e.cursors)return _.onError("expected status cursors, got null or undefined",{originalError:null}),[2];if(null==e.version)return _.onError("expected status version, got null or undefined",{originalError:null}),[2];if(_.isReconnecting)return _.handleReconnect(e.contents,e.version),[2];return _.dataloss&&_.shouldTrackDataLoss&&_.dataloss.checkAndTrack({serverContent:e.contents,serverVersion:e.version,replId:_.replId,filePath:_.linkedFile.toString(),fetchOps:_.fetchOps,logger:_.logger}),_.serverContent=e.contents,_.localContent=_.serverContent,_.version=e.version,_.emit("firstConnect"),_.emit("changes",u.as.of({from:0,insert:_.serverContent},0)),e.cursors.forEach(_.handleNewCursor),_.emit("fileDirty"),_.debounceCommit(),[2]}return[4,_.channel.request({otLinkFile:{file:{path:_.linkedFile.toString()}}})];case 1:if((n=a.sent()).channelClosed)return[2];if(n.error)return _.onError("link file error "+n.error.replace(_.linkedFile.toString(),"$FILENAME"),{originalError:n.error}),[2];if(!n.otLinkFileResponse)return _.onError("unexpected link file response: "+JSON.stringify(n.toJSON()),{originalError:null}),[2];if(r=n.otLinkFileResponse.version,i=p.Z.from(null!==(o=null===(t=n.otLinkFileResponse.linkedFile)||void 0===t?void 0:t.content)&&void 0!==o?o:"").toString(),_.isReconnecting)return _.handleReconnect(i,r),[2];return _.dataloss&&_.shouldTrackDataLoss&&_.dataloss.checkAndTrack({serverContent:i,serverVersion:r,replId:_.replId,filePath:_.linkedFile.toString(),fetchOps:_.fetchOps,logger:_.logger}),_.serverContent=i,_.localContent=_.serverContent,_.version=r,_.committedVersion=r,_.committedContent=_.serverContent,_.emit("firstConnect"),_.emit("changes",u.as.of({from:0,insert:_.serverContent},0)),[2]}})}),function(e){return g.apply(this,arguments)});var D=(0,E._)(S);S.handleReconnect=(m=(0,r._)(function(e,t){var n,r,a,s,u,l,f,d,h,p,v,g,m,y,C,w,E,b,S,_,x,T,F,O,R,M,A,N,I,J,U,B,Z,V,W,q,j,z,H,Q,G,K,X,Y,$,ee,et,en,er,eo,ei;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if(!D.timeDisconnected)throw Error("wat");if(n=Date.now()-D.timeDisconnected,r={case:"other",remoteContent:e,localContent:D.localContent},a=function(r){D.reconnectTrackedData=(0,i._)((0,o._)({},r),{serverVersion:t,ourVersion:D.version,ourCommittedVersion:D.committedVersion,areContentsEqual:D.serverContent===e,areCommittedContentsEqual:D.committedContent===e,didReceiveOpsWhileReconnecting:!!D.bufferedReconnectingOps.length,didEditOffline:D.didEditOffline,hasPendingOps:!!D.pending.length,hasUncommittedMultiplayerOps:D.hasUncommittedMultiplayerOps,disconnectDuration:n});var a={};("has_inflight_happy_path_ops_reached"===r.case||"has_inflight"===r.case||"multiplayer"===r.case)&&.1>Math.random()&&(a={hasAdditionalLogs:!0,localContent:String(D.localContent),ourContent:String(D.serverContent),ourCommittedContent:String(D.committedContent),ourInflight:JSON.stringify(D.inflight),ourPending:JSON.stringify(D.pending),serverContent:String(e)}),D.logger.info("OT Client: Reconnect",(0,P.P1)((0,o._)({},D.reconnectTrackedData,a))),D.track&&D.track(L.U3.FILE_RECONNECTED_STATUS2,D.reconnectTrackedData)},s=function(e,t){a({case:e,originCase:t,prompted:!1}),D.isReconnecting=!1,D.bufferedReconnectingOps=[],D.didEditOffline=!1,D.timeDisconnected=null,D.debounceSend(),D.debounceCommit(),D.emit("transparentReconnect",{case:e,originCase:t})},u=function(n){if(r.remoteContent===r.localContent){D.version=t,D.committedVersion=t,D.localContent=e,D.committedContent=e,D.serverContent=e,D.inflight=[],D.pending=[],s("unprompted_because_identical",n);return}a({case:n,prompted:!0}),r.case=n,D.emit("promptUserReconnect",r)},D.inflight.length){if(t===D.version&&D.serverContent===e)return D.pending=k.type.compose(D.inflight,D.pending),D.inflight=[],D.inflightOpsPromise=null,s("has_inflight_happy_path_ops_unreached"),[2];l=!1,f=D.serverContent;try{f=k.type.apply(f,D.inflight)}catch(e){l=!0}if(!l&&D.version+1===t&&f===e)return D.inflight=[],D.inflightOpsPromise=null,D.serverContent=e,D.version=t,s("has_inflight_happy_path_ops_reached"),[2];return u("has_inflight"),[2]}if(D.hasUncommittedMultiplayerOps)return u("multiplayer"),[2];if(D.version===t){if(e===D.serverContent)return s("happy_path"),[2];return u("same_version_different_content"),[2]}if(D.committedVersion===t){d=e;try{h=!0,p=!1,v=void 0;try{for(g=D.uncommittedOps[Symbol.iterator]();!(h=(m=g.next()).done);h=!0)y=m.value.op,d=k.type.apply(d,y)}catch(e){p=!0,v=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw v}}}catch(e){return u("same_committed_version_unable_to_apply_ops"),[2]}if(d===D.serverContent){C=[],w=!0,E=!1,b=void 0;try{for(S=D.uncommittedOps[Symbol.iterator]();!(w=(_=S.next()).done);w=!0)x=_.value.op,C=k.type.compose(C,x)}catch(e){E=!0,b=e}finally{try{w||null==S.return||S.return()}finally{if(E)throw b}}return D.pending=k.type.compose(C,D.pending),D.uncommittedOps=[],D.version=t,D.serverContent=e,s("happy_path_uncommitted"),[2]}return u("same_committed_version_different_content_fixed"),[2]}if(!(D.version<t))return[3,3];return[4,D.fetchOps(D.version+1,t)];case 1:T=c.sent(),F=!1,O=D.serverContent;try{R=!0,M=!1,A=void 0;try{for(N=T[Symbol.iterator]();!(R=(I=N.next()).done);R=!0)J=I.value.op,O=k.type.apply(O,J)}catch(e){M=!0,A=e}finally{try{R||null==N.return||N.return()}finally{if(M)throw A}}}catch(e){F=!0}if(!F&&O===e){U=!0,B=!1,Z=void 0;try{for(V=T[Symbol.iterator]();!(U=(W=V.next()).done);U=!0)q=W.value,D.handlePacket(q,{overrideReconnectingBuffer:!0})}catch(e){B=!0,Z=e}finally{try{U||null==V.return||V.return()}finally{if(B)throw Z}}j=!0,z=!1,H=void 0;try{for(Q=D.bufferedReconnectingOps[Symbol.iterator]();!(j=(G=Q.next()).done);j=!0)K=G.value,D.handlePacket(K,{overrideReconnectingBuffer:!0})}catch(e){z=!0,H=e}finally{try{j||null==Q.return||Q.return()}finally{if(z)throw H}}return s("happy_path_server_ahead"),[2]}return[4,D.fetchOps(D.committedVersion+1,t)];case 2:X=c.sent(),Y=!1,$=D.committedContent;try{ee=!0,et=!1,en=void 0;try{for(er=X[Symbol.iterator]();!(ee=(eo=er.next()).done);ee=!0)ei=eo.value.op,$=k.type.apply($,ei)}catch(e){et=!0,en=e}finally{try{ee||null==er.return||er.return()}finally{if(et)throw en}}}catch(e){Y=!0}if(!Y&&$===e)return u("happy_path_uncommitted_server_ahead"),[2];return u("uncommitted_server_ahead"),[2];case 3:return u("other"),[2]}})}),function(e,t){return m.apply(this,arguments)});var x=(0,E._)(S);S.flush=(0,r._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,x.commitPromise];case 1:return e.sent(),x.debounceCommit(),x.debounceCommit.flush(),[4,x.commitPromise];case 2:return e.sent(),[2]}})}),S.isFileSaved=function(){return!0};var O=(0,E._)(S);S.fetchOps=(y=(0,r._)(function(e,t){var n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:if(!O.channel)throw Error("No channel, cannot fetchOps");return[4,O.channel.request({otFetchRequest:{versionFrom:e,versionTo:t}})];case 1:if((n=r.sent()).channelClosed)throw Error("Channel closed while requesting");if(n.error)throw Error("Fetch ops returned an error: "+n.error);if(!n.otFetchResponse)throw Error("Expected otFetchResponse");if(!n.otFetchResponse.packets)throw Error("Expected otFetchResponse.packets");return[2,n.otFetchResponse.packets.map(function(e){var t=e.crc32,n=e.op,r=e.version,o=e.userId,i=e.committed,a=e.author;if(null==t)throw Error("Expected crc32 in packet");if(null==n)throw Error("Expected op in packet");if(null==r)throw Error("Expected version in packet");return{crc32:t,version:r,op:(0,M.ug)(n),userId:o,timestamp:i?1e3*i.seconds:0,author:a}})]}})}),function(e,t){return y.apply(this,arguments)});var N=(0,E._)(S);S.fetchChanges=(C=(0,r._)(function(e,t,n){var r,o;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return[4,N.fetchOps(e,t)];case 1:return r=i.sent(),o=n,[2,r.map(function(e){var t=e.op,n=e.version,r=e.userId,i=e.timestamp,a=e.crc32,s=(0,M.mt)(t,o),c=s.changes,u=s.docAfter,l=c.invert((0,M.tT)(o));return o=u,{changes:c,invertedChanges:l,userId:r,version:n,timestamp:i,crc32:a}})]}})}),function(e,t,n){return C.apply(this,arguments)});var I=(0,E._)(S);S.transformSelection=(w=(0,r._)(function(e){var t,n,r,o,i,a,s,u;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if(t=e.indexStart,n=e.indexEnd,r=e.versionFrom,o=e.versionTo,!I.channel)throw Error("No channel, cannot transformSelection");return[4,I.channel.request({otTransformSelectionRequest:{indexStart:t,indexEnd:n,versionFrom:r,versionTo:o}})];case 1:if(!(i=c.sent()).otTransformSelectionResponse)throw Error("Expected otTransformSelectionResponse");return[2,{indexStart:null!==(a=i.otTransformSelectionResponse.indexStart)&&void 0!==a?a:0,indexEnd:null!==(s=i.otTransformSelectionResponse.indexEnd)&&void 0!==s?s:0,version:null!==(u=i.otTransformSelectionResponse.version)&&void 0!==u?u:0}]}})}),function(e){return w.apply(this,arguments)}),S.getLocalContent=function(){return(0,M.f5)(S.localContent)},S.getRawLocalContent=function(){return S.localContent},S.shouldTrackDataLoss=!1,S.replId="",S.linkedFile=e,S.channel=null,S.inflight=[],S.inflightOpsPromise=null,S.uncommittedOps=[],S.hasUncommittedMultiplayerOps=!1,S.committedVersion=-1,S.isReconnecting=!1,S.bufferedReconnectingOps=[],S.didEditOffline=!1,S.pending=[],S.metadata={},S.version=-1,S.serverContent="",S.localContent="",S.committedContent="",S.flushedCursorIds=[],S.pendingCursors=[],S.user=null,S.flushFailed=0,S.debounceSend=T()(function(){return S.sendOp()},20,{maxWait:60});var J=T()(function(){return S.commitToDisk()},1e3,{maxWait:3e3}),U=function(){if(!S.channel)throw Error("Tryna commit while offline");if(S.isReconnecting)throw Error("Committing while reconnecting");return J()};U.cancel=J.cancel,U.flush=J.flush,S.debounceCommit=U,S.commitPromise=null,S.timeDisconnected=null;var B=!1;return S.destroy=function(){B=!0},S.logger=f,S.track=v,S.dataloss=d,s.then(function(){B||(S.destroy=a.openChannel({service:"ot",name:"ot:".concat(e)},function(t){var n=t.channel,r=t.context;return S.shouldTrackDataLoss=!window.navigator.userAgent.includes("Firefox"),S.replId=r.repl.id,S.dataloss&&S.shouldTrackDataLoss&&S.dataloss.ensureTrackedFile({replId:S.replId,filePath:e.toString()}),S.user=r.currentUser?{name:r.currentUser.username,id:r.currentUser.id}:null,S.channel=n,n.onCommand(function(e){switch(e.body){case"ot":if(!e.ot||null==e.ot.op||null==e.ot.spookyVersion||null==e.ot.crc32){var t,n,r;S.onError("missing data in ot packet",{originalError:null,op:null===(t=e.ot)||void 0===t?void 0:t.op,spookyVersion:null===(n=e.ot)||void 0===n?void 0:n.spookyVersion,crc32:null===(r=e.ot)||void 0===r?void 0:r.crc32});return}if(-1===S.version)return;var o={crc32:e.ot.crc32,op:(0,M.ug)(e.ot.op),version:e.ot.spookyVersion};return S.handlePacket(o,{overrideReconnectingBuffer:!1});case"otstatus":return S.handleStatus(e.otstatus);case"error":if(e.ref)return;return S.onError("Unknown protocol error OT channel",{originalError:e.error||"no error"});case"otNewCursor":return S.handleNewCursor(e.otNewCursor);case"otDeleteCursor":return S.handleDeleteCursor(e.otDeleteCursor)}}),function(){S.channel=null,S.isReconnecting=!0,S.debounceSend.cancel(),S.debounceCommit.cancel(),S.timeDisconnected||(S.timeDisconnected=Date.now())}}))}),S}return n.prototype.commitToDisk=function(){var e=this;return(0,r._)(function(){var t,n,r,o,i,a;return(0,c.Jh)(this,function(s){switch(s.label){case 0:if(!e.channel)throw Error("Tryna commit while offline");if("open"!==e.channel.status)return[2];if(e.isReconnecting)throw Error("Committing while reconnecting");if(e.isClean())return[2];if(e.commitPromise)return e.debounceCommit(),[2];if(t=function(){},e.commitPromise=new Promise(function(e){return t=e}),!e.inflightOpsPromise)return[3,2];return[4,e.inflightOpsPromise];case 1:if(s.sent().channelClosed)return e.commitPromise=null,t(),[2];s.label=2;case 2:if(!(e.pending.length>0))return[3,4];if(e.debounceSend(),e.debounceSend.flush(),!e.inflightOpsPromise)return e.commitPromise=null,t(),e.onError("expected inflight promise",{originalError:null}),[2];return[4,e.inflightOpsPromise];case 3:if(s.sent().channelClosed)return e.commitPromise=null,t(),[2];s.label=4;case 4:return e.emit("commitStart"),n=e.version,r=e.serverContent,[4,e.channel.request({flush:{consistency:l.api.Flush.Consistency.Disk}})];case 5:if((o=s.sent()).channelClosed)return e.flushFailed=0,e.commitPromise=null,t(),[2];if("ok"!==o.body){if(e.commitPromise=null,t(),R(i=o.error||o.toString(),[F.Df.NotFound,F.Df.AlreadyExists,F.Df.NotDirectory,F.Df.IsDirectory,F.Df.DiskQuotaExceeded]))return e.onError("unable to flush",{originalError:i}),[2];return e.flushFailed++,setTimeout(function(){!e.isReconnecting&&e.channel&&"open"===e.channel.status&&e.debounceCommit()},Math.min(Math.random()*(Math.pow(2,e.flushFailed)-1)*1e3,1024e3)),[2]}return e.dataloss&&e.shouldTrackDataLoss&&(a=e.uncommittedOps[e.uncommittedOps.length-1])&&e.dataloss.storeOp({replId:e.replId,filePath:e.linkedFile.toString(),op:{crc32:a.crc32,version:a.version},opType:"latestFlushedOp",logger:e.logger,isReconnecting:e.isReconnecting}),e.uncommittedOps=[],e.hasUncommittedMultiplayerOps=!1,e.committedVersion=n,e.committedContent=r,e.flushFailed=0,e.emit("commitComplete",n),e.isClean()&&e.emit("fileClean"),e.commitPromise=null,t(),[2,o]}})})()},n}(D.EventEmitter),I=n(73372),J="SYNTHETIC_FILE_PATH.sql";function U(e){var t,n,E=e.container,b=e.dataloss,S=e.track,_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=[];return{enqueue:function(n){for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];if(t.length>=e)throw Error("fs: We retried too many things during a closed channel.");return new Promise(function(e){t.push(e)}).then(function(){return n.apply(void 0,(0,s._)(o))})},flush:function(){t.splice(0,t.length).forEach(function(e){return e()})}}}(),D=_.enqueue,k=_.flush,x=!1,T=null,O=null,M=null,P=0,L=new Map,A=new Map,U=new Map,B=[],Z=new Map;E.openChannel({service:"fsevents"},function(e){var t=e.channel;T=t,t.onCommand(function(e){if("fileEvent"===e.body){if(!e.fileEvent)throw Error("Expected fileEvent");var t=e.fileEvent,n=t.file,r=t.dest,o=t.op;if(n){var i=n.path;if(null!==i&&null!==o&&void 0!==i&&void 0!==o){var a=(0,y.S1)(i);if(Q(),L.get(a)||n.type===l.api.File.Type.DIRECTORY)s=F.Tv.Directory;else{var s,c,u=Array.from(L.keys()).find(function(e){return(0,y.MO)(e,a)}),d=u&&(null===(c=L.get(u))||void 0===c?void 0:c.children.find(function(e){return e.filename===(0,y.Bf)(a)}));s=d?d.type:F.Tv.File}switch(o){case l.api.FileEvent.Op.Create:en({eventType:F.kS.Create,node:{path:a,type:s}});break;case l.api.FileEvent.Op.Modify:if(s===F.Tv.Directory){f.$e(function(e){e.setTag("service","fs"),e.setExtra("path-str",i),e.setExtra("op",o),e.setExtra("file-type",s),f.Tb(Error("Unexpected modify directory event"))});break}en({eventType:F.kS.Modify,node:{path:a,type:s}});break;case l.api.FileEvent.Op.Remove:en({eventType:F.kS.Delete,node:{path:a,type:s}});break;case l.api.FileEvent.Op.Move:if(null==r||null==r.path)throw Error("Expected dest path");var h=r.path;en({eventType:F.kS.Move,node:{path:a,type:s},to:(0,y.S1)(h)})}}}}});var n=(0,s._)(new Set((0,s._)(L.keys()).concat((0,s._)(A.keys()),(0,s._)(U.keys()))));return n.length&&t.send({subscribeFile:{files:n.map(function(e){return{path:e.toString()}})}}),function(){T=null}});var V=new Promise(function(e){return n=e});E.openChannel({service:function(e){return e.repl.authorizations.editFileContents.isAuthorized?"gcsfiles":"files"}},function(e){var t=e.channel;n(t),k();var r=(0,s._)(L.keys()).sort(),o=!0,i=!1,a=void 0;try{for(var c,u=r[Symbol.iterator]();!(o=(c=u.next()).done);o=!0)!function(){var e=c.value;es.readDir(e).then(function(t){var n=L.get(e);if(n){if(t.error){en({eventType:F.kS.Delete,node:{path:e,type:F.Tv.Directory}});return}var r=t.children,o=n.children,i=o.filter(function(e){return!r.some(function(t){return t.filename===e.filename&&t.type===e.type})}),a=!0,s=!1,c=void 0;try{for(var u,l=i[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var f=u.value;en({eventType:F.kS.Delete,node:{path:(0,y.K1)(e,f.filename),type:f.type}})}}catch(e){s=!0,c=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw c}}var d=r.filter(function(e){return!o.some(function(t){return t.filename===e.filename&&t.type===e.type})}),h=!0,p=!1,v=void 0;try{for(var g,m=d[Symbol.iterator]();!(h=(g=m.next()).done);h=!0){var C=g.value;en({eventType:F.kS.Create,node:{path:(0,y.K1)(e,C.filename),type:C.type}})}}catch(e){p=!0,v=e}finally{try{h||null==m.return||m.return()}finally{if(p)throw v}}}})}()}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}var l=!0,f=!1,d=void 0;try{for(var h,p=U.keys()[Symbol.iterator]();!(l=(h=p.next()).done);l=!0)!function(){var e=h.value;es.readFile(e,{fromDisk:!0}).then(function(t){var n=U.get(e);if(n){if(t.error){en({eventType:F.kS.Delete,node:{path:e,type:F.Tv.File}});return}t.content.toBuffer().equals(n.latestContent.toBuffer())||en({eventType:F.kS.Modify,node:{path:e,type:F.Tv.File}})}})}()}catch(e){f=!0,d=e}finally{try{l||null==p.return||p.return()}finally{if(f)throw d}}return function(){V=new Promise(function(e){return n=e})}});var W=(0,m.Z)();W.promise.catch(function(e){return e});var q=(0,v.Z)((0,r._)(function(){var e;return(0,c.Jh)(this,function(t){switch(t.label){case 0:return[4,W.promise];case 1:return[4,t.sent().request({fsSnapshot:{}})];case 2:if((e=t.sent()).channelClosed)return[2,{success:!1,error:"channel closed"}];if(e.error)return[2,{success:!1,error:e.error}];return[2,{error:null,success:!0}]}})}),{wait:5e3,maxWait:1e4});E.openChannel({service:"snapshot",skip:function(e){return!e.repl.authorizations.editFileContents.isAuthorized}},function(e){var t=e.channel;return W.resolve(t),function(){W.isFulfilled&&(W=(0,m.Z)()).promise.catch(function(e){return e})}});var j=F.kO.Clean,z=[],H=0;function Q(){return G.apply(this,arguments)}function G(){return(G=(0,r._)(function(){var e;return(0,c.Jh)(this,function(t){switch(t.label){case 0:return H++,K(),[4,es.persist()];case 1:return(e=t.sent()).error&&d.kg.error("Failed to persist, something very bad has probably happened",{originalError:e.error}),H--,K(),[2]}})})).apply(this,arguments)}function K(){return X.apply(this,arguments)}function X(){return(X=(0,r._)(function(){var e;return(0,c.Jh)(this,function(t){return(e=0===H&&0===Y.length&&Array.from(A.values()).every(function(e){return e.otClient.isClean()}))===(j===F.kO.Clean)||(j=e?F.kO.Clean:F.kO.Syncing,z.forEach(function(e){e(j,{hasUserChanged:x})})),[2]})})).apply(this,arguments)}var Y=[];function $(e){x=!0,Y.push(e),K(),e.then(function(){var t=Y.indexOf(e);t>-1&&Y.splice(t,1),Q()})}function ee(e,t){return et.apply(this,arguments)}function et(){return(et=(0,r._)(function(e,t){var n,o;return(0,c.Jh)(this,function(i){var a;return a=(0,r._)(function(){var t,r,o;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return[4,V];case 1:if("open"!==(t=i.sent()).status)return[2,D(n)];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,t.request(e)];case 3:return r=i.sent(),[3,5];case 4:return o=i.sent(),f.Tb(Error("Send request failed with error: ".concat(o))),[2,D(n)];case 5:if(r.channelClosed)return[2,D(n)];return[2,r]}})}),o=(n=function(){return a.apply(this,arguments)})(),t.isMutative&&$(o),[2,o]})})).apply(this,arguments)}function en(e){M=null;var t=(0,y.DH)(e.node.path),n=L.get(t),r=(0,y.Bf)(e.node.path);if(!r)throw Error("Expected filename");var a=null;if(e.eventType===F.kS.Move){var c=(0,y.DH)(e.to);a=L.get(c)}if(n||a)switch(e.eventType){case F.kS.Create:if(!n)break;var u=(0,s._)(n.children.filter(function(e){return e.filename!==r})).concat([{type:e.node.type,filename:r}]),l=!0,d=!1,h=void 0;try{for(var p,v=n.listeners[Symbol.iterator]();!(l=(p=v.next()).done);l=!0)(0,p.value.onChange)(u)}catch(e){d=!0,h=e}finally{try{l||null==v.return||v.return()}finally{if(d)throw h}}n.children=u;break;case F.kS.Move:var g=(0,y.Bf)(e.to);if(n&&n===a){var m=(0,s._)(n.children.filter(function(e){return e.filename!==r&&e.filename!==g})).concat([{type:e.node.type,filename:g}]),C=!0,w=!1,E=void 0;try{for(var b,S=n.listeners[Symbol.iterator]();!(C=(b=S.next()).done);C=!0)(0,b.value.onChange)(m)}catch(e){w=!0,E=e}finally{try{C||null==S.return||S.return()}finally{if(w)throw E}}n.children=m;break}if(n){var _=n.children.filter(function(e){return e.filename!==r}),D=!0,k=!1,x=void 0;try{for(var T,O=n.listeners[Symbol.iterator]();!(D=(T=O.next()).done);D=!0)(0,T.value.onChange)(_)}catch(e){k=!0,x=e}finally{try{D||null==O.return||O.return()}finally{if(k)throw x}}n.children=_}if(a){var R=(0,s._)(a.children.filter(function(e){return e.filename!==r&&e.filename!==g})).concat([{type:e.node.type,filename:g}]),P=!0,N=!1,I=void 0;try{for(var J,B=a.listeners[Symbol.iterator]();!(P=(J=B.next()).done);P=!0)(0,J.value.onChange)(R)}catch(e){N=!0,I=e}finally{try{P||null==B.return||B.return()}finally{if(N)throw I}}a.children=R}break;case F.kS.Delete:if(!n)break;var Z=n.children.filter(function(e){return e.filename!==r}),V=!0,W=!1,q=void 0;try{for(var j,z=n.listeners[Symbol.iterator]();!(V=(j=z.next()).done);V=!0)(0,j.value.onChange)(Z)}catch(e){W=!0,q=e}finally{try{V||null==z.return||z.return()}finally{if(W)throw q}}n.children=Z;break;case F.kS.Modify:break;default:throw Error("unknown event")}switch(e.eventType){case F.kS.Move:case F.kS.Delete:var H=[A.get(e.node.path),U.get(e.node.path),L.get(e.node.path)],Q=!0,G=!1,K=void 0;try{for(var X,Y=H[Symbol.iterator]();!(Q=(X=Y.next()).done);Q=!0){var $=X.value;if($){var ee=!0,et=!1,er=void 0;try{for(var eo,ei=$.listeners[Symbol.iterator]();!(ee=(eo=ei.next()).done);ee=!0){var ea=eo.value,ec=ea.onMoveOrDelete,eu=ea.dispose;ec&&ec(e),eu()}}catch(e){et=!0,er=e}finally{try{ee||null==ei.return||ei.return()}finally{if(et)throw er}}}}}catch(e){G=!0,K=e}finally{try{Q||null==Y.return||Y.return()}finally{if(G)throw K}}if(e.node.type===F.Tv.File)break;var el=(0,s._)(new Set((0,s._)(L.keys()).concat((0,s._)(U.keys()),(0,s._)(A.keys())))).map(function(e){var t=A.get(e)||U.get(e)||L.get(e);if(!t)throw Error("expected node");return t}),ef=[],ed=!0,eh=!1,ep=void 0;try{for(var ev,eg=el.sort()[Symbol.iterator]();!(ed=(ev=eg.next()).done);ed=!0){var em=ev.value;if((0,y.X2)(e.node.path,em.path)){var ey=ef.slice(-1)[0];if(!(ey&&(0,y.X2)(ey,em.path))){var eC={eventType:F.kS.Delete,node:{path:em.path,type:em.type}};e.eventType===F.kS.Move&&(eC=(0,i._)((0,o._)({},eC),{eventType:F.kS.Move,to:(0,y.eB)(e.node.path,e.to,em.path)})),ef.push(em.path),en(eC)}}}}catch(e){eh=!0,ep=e}finally{try{ed||null==eg.return||eg.return()}finally{if(eh)throw ep}}break;case F.kS.Create:case F.kS.Modify:if(!U.has(e.node.path))break;es.readFile(e.node.path,{fromDisk:!0}).then(function(t){var n=U.get(e.node.path);if(n){if(t.error){en({eventType:F.kS.Delete,node:{path:e.node.path,type:F.Tv.File}});return}n.latestContent=t.content;var r=!0,o=!1,i=void 0;try{for(var a,s=n.listeners[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value.onChange;c&&c(t.content)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}}).catch(function(e){e.message="File read after modify error: "+e.message,f.Tb(e)})}}function er(e){var t=!0,n=!1,r=void 0;try{for(var o,i=B[Symbol.iterator]();!(t=(o=i.next()).done);t=!0)(0,o.value)(e)}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}function eo(){return(eo=(0,r._)(function(){var e,t,n,r,o,i,a;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if(!(null===(n=E.getContext())||void 0===n?void 0:null===(t=n.repl)||void 0===t?void 0:t.language))throw Error("Expected repl language");return[4,(e=E).execImmediately.apply(e,["rg","--hidden","--files"].concat((0,s._)(w.hD.flatMap(function(e){return["--glob","!".concat(e)]}))))];case 1:if(o=(r=c.sent()).output,i=r.error,a=function(e){return!(!e||(0,w.Ci)(e))},!i&&o)return[2,M={error:null,files:o.split("\n").filter(a)}];return"exit status 1"!==i&&f.Tb(Error("Find file command failed with error: ".concat(i))),[2,{error:i,files:null}]}})})).apply(this,arguments)}var ei=(t=(0,r._)(function(e,t,n){var o,i,a,s,u,l,f,d;function p(e){return v.apply(this,arguments)}function v(){return(v=(0,r._)(function(e){var t;return(0,c.Jh)(this,function(n){switch(n.label){case 0:return[4,o.request(e)];case 1:if((t=n.sent()).channelClosed)throw Error("channelClosed");if(t.error)throw Error(t.error);return[2,t]}})})).apply(this,arguments)}return(0,c.Jh)(this,function(r){switch(r.label){case 0:if(e===I.wL)return[2,{error:F.Df.InvalidPath}];return[4,V];case 1:o=r.sent(),i={eventType:F.kS.Create,node:{path:e,type:F.Tv.File}},r.label=2;case 2:return r.trys.push([2,9,,10]),[4,p({transferStart:{path:e.toString(),size:t.length}})];case 3:if(!(a=r.sent().transfer))throw Error("Failed to start a transfer (no transfer id)");s=t.toBuffer(),u=512e3,n(s.length,0),l=0,r.label=4;case 4:if(!(l<Math.ceil(t.length/u)))return[3,7];return[4,p({transferChunk:{id:a.id,content:s.subarray(l*u,(l+1)*u)}})];case 5:r.sent(),n(s.length,Math.min(s.length,(l+1)*u)),r.label=6;case 6:return l++,[3,4];case 7:return[4,p({transferComplete:{id:a.id,crc32:h.buf(s)}})];case 8:return r.sent(),[3,10];case 9:if("channelClosed"===(f=r.sent()).message)return[2,D(es.transferFile,e,t,n)];if((d=R(f.message,[F.Df.NotDirectory,F.Df.AlreadyExists,F.Df.DiskQuotaExceeded]))===F.Df.DiskQuotaExceeded&&er(i),d===F.Df.AlreadyExists&&(d=F.Df.IsDirectory),d)return[2,{error:d}];throw f;case 10:return en(i),[2,{error:null}]}})}),function(e,n,r){return t.apply(this,arguments)});function ea(e){var t=new N(e,E,Promise.all((0,s._)(Y).map(function(e){return e.catch(function(){})})).then(function(){}),E.logger,b,S);return t.on("commitComplete",Q),t.on("fileDirty",K),t.on("fileClean",K),t.on("commitStart",K),t}var es={getStatus:function(){return j},onStatusChange:function(e){return z.push(e),function(){var t=z.indexOf(e);t>-1&&z.splice(t,1)}},watchDir:function(e,t){var n=!1,r=function(){n=!0;var t=L.get(e);t&&(t.listeners=t.listeners.filter(function(e){return e.dispose!==r}),0===t.listeners.length&&L.delete(e))};return es.readDir(e).then(function(a){if(!n){if(a.error){var s=Error(a.error);s.code=a.error,t.onError(s),r();return}var c=L.get(e);!c&&(c={path:e,type:F.Tv.Directory,children:a.children,listeners:[]},L.set(e,c),T&&T.send({subscribeFile:{files:[{path:e.toString()}]}})),c.listeners.push((0,i._)((0,o._)({},t),{dispose:r})),t.onChange(a.children)}}).catch(function(e){r(),t.onError(e)}),r},watchPathStat:function(e,t){var n=0,r=!1,o=function(i,s,c){if(s===F.Tv.File)return function(){};var u=(0,a._)(c),l=u[0],f=u.slice(1),d=l===e;if(d&&0!==f.length)throw Error("Invariant: child is target but has more children");var h=null,p=es.watchDir(i,{onChange:function(i){var a=i.find(function(e){return e.filename===(0,y.Bf)(l)});if(!a){r||(t.onNewStat({exists:!1}),r=!0),h&&(h.dispose(),h=null);return}if(h&&a.type!==h.node.type&&(h.dispose(),h=null),!h){if(d){var s=++n;es.stat(e).then(function(e){s===n&&e.exists&&(t.onNewStat(e),r=!1,h={node:a,dispose:function(){}})});return}h={node:a,dispose:o(l,a.type,f)}}},onError:t.onError});return function(){null==h||h.dispose(),p()}},i=(0,a._)((0,y.nV)(e)),s=i[0],c=i.slice(1);return o(s,F.Tv.Directory,c)},watchFilePath:function(e,t){var n,r=function(e,n){if(0===n.length){var o=es.watchFile((0,y.S1)(e),t);return function(){o()}}var i,a=n[0],s=!1,c=es.watchDir((0,y.S1)(e),{onChange:function(t){var o=t.find(function(e){return e.filename.toString()===a});if(!s&&o){i=r("".concat(e,"/").concat(a),n.slice(1)),s=!0;return}s=!1},onMoveOrDelete:function(){null==i||i()},onError:function(){}});return function(){null==i||i(),c()}},o=e.toString().split("/"),i=!1,a=es.watchDir((0,y.S1)(""),{onChange:function(e){var t=e.find(function(e){return e.filename.toString()===o[0]});if(!i&&t){n=r(o[0],o.slice(1)),i=!0;return}i=!1},onError:function(){}});return function(){null==n||n(),a()}},writeFile:function(e,t){return(0,r._)(function(){var n,r,o,i,a,s;return(0,c.Jh)(this,function(c){switch(c.label){case 0:return r="string"==typeof t?p.Z.from(t).toBuffer():t.toBuffer(),[4,ee({write:{path:e.toString(),content:r}},{isMutative:!0})];case 1:if(o=c.sent(),a=null===(n=L.get((0,y.DH)(e)))||void 0===n?void 0:n.children.some(function(t){return t.filename===(0,y.Bf)(e)}),i=U.has(e)||A.has(e)||a?{eventType:F.kS.Modify,node:{path:e,type:F.Tv.File}}:{eventType:F.kS.Create,node:{path:e,type:F.Tv.File}},o.error){if((s=R(o.error,[F.Df.NotDirectory,F.Df.AlreadyExists,F.Df.DiskQuotaExceeded]))===F.Df.DiskQuotaExceeded&&er(i),s===F.Df.AlreadyExists&&(s=F.Df.IsDirectory),!s)throw Error(o.error);return[2,{error:s}]}return en(i),[2,{error:null}]}})})()},transferFile:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r._)(function(){var e;return(0,c.Jh)(this,function(n){return $(e=ei.apply(void 0,(0,s._)(t))),[2,e]})})()},readFile:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromDisk:!1}).fromDisk;return(0,r._)(function(){var n,r,o;return(0,c.Jh)(this,function(i){switch(i.label){case 0:if(!t&&(n=A.get(e))&&n.otClient.getRawLocalContent()&&!n.otClient.isReconnecting)return[2,{content:p.Z.from(n.otClient.getRawLocalContent()),error:null}];return[4,ee({read:{path:e.toString()}},{isMutative:!1})];case 1:if((r=i.sent()).error){if(!(o=R(r.error,[F.Df.NotFound,F.Df.IsDirectory])))throw Error(r.error);return[2,{error:o}]}if(!r.file||!r.file.path||!r.file.content)throw Error("Expected file");return[2,{content:p.Z.from(r.file.content),error:null}]}})})()},createDir:function(e){return(0,r._)(function(){var t,n,r;return(0,c.Jh)(this,function(o){switch(o.label){case 0:return[4,ee({mkdir:{path:e.toString()}},{isMutative:!0})];case 1:if(t=o.sent(),n={eventType:F.kS.Create,node:{path:e,type:F.Tv.Directory}},t.error){if((r=R(t.error,[F.Df.NotDirectory,F.Df.DiskQuotaExceeded]))===F.Df.DiskQuotaExceeded&&er(n),!r)throw Error(t.error);return[2,{error:r}]}return en(n),[2,{error:null}]}})})()},moveDir:function(e,t){return(0,r._)(function(){var n,r,o;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return[4,ee({move:{oldPath:e.toString(),newPath:t.toString()}},{isMutative:!0})];case 1:if(n=i.sent(),r={eventType:F.kS.Move,node:{path:e,type:F.Tv.Directory},to:t},n.error){if((o=R(n.error,[F.Df.NotFound,F.Df.AlreadyExists,F.Df.NotDirectory,F.Df.DiskQuotaExceeded]))===F.Df.DiskQuotaExceeded&&er(r),!o)throw Error(n.error);return[2,{error:o}]}return en(r),[2,{error:null}]}})})()},moveFile:function(e,t){return(0,r._)(function(){var n,r,o;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return[4,ee({move:{oldPath:e.toString(),newPath:t.toString()}},{isMutative:!0})];case 1:if(n=i.sent(),r={eventType:F.kS.Move,node:{path:e,type:F.Tv.File},to:t},n.error){if((o=R(n.error,[F.Df.NotFound,F.Df.AlreadyExists,F.Df.NotDirectory,F.Df.DiskQuotaExceeded]))===F.Df.DiskQuotaExceeded&&er(r),!o)throw Error(n.error);return[2,{error:o}]}return en(r),[2,{error:null}]}})})()},copyFile:function(e,t){return(0,r._)(function(){var n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,es.readFile(e)];case 1:if((n=r.sent()).error)return[2,n];return[2,es.writeFile(t,n.content)]}})})()},copyDirFromRemote:function(e,t,n){return(0,r._)(function(){var r,o,i,a,s,u,l,f,d,h,p,v,g;return(0,c.Jh)(this,function(c){switch(c.label){case 0:return[4,this.deleteDir(e)];case 1:return c.sent(),[4,n.readDir(e)];case 2:if((r=c.sent()).error)return[2,r];return[4,this.readDir(t)];case 3:if((o=c.sent()).error!==F.Df.NotFound)return[3,5];return[4,this.createDir(e)];case 4:return c.sent(),[3,6];case 5:if(o.error===F.Df.NotDirectory)return[2,o];c.label=6;case 6:i=!0,a=!1,s=void 0,c.label=7;case 7:c.trys.push([7,15,16,17]),u=r.children[Symbol.iterator](),c.label=8;case 8:if(i=(l=u.next()).done)return[3,14];if(f=l.value,d=(0,y.K1)(e,f.filename),f.type!==F.Tv.File)return[3,11];return[4,n.readFile(d)];case 9:if((h=c.sent()).error)return[2,h];return[4,this.writeFile((0,y.K1)(t,f.filename),h.content)];case 10:if((p=c.sent()).error)return[2,p];return[3,13];case 11:if(f.type!==F.Tv.Directory)return[3,13];return[4,this.copyDirFromRemote(d,(0,y.K1)(t,f.filename),n)];case 12:if((v=c.sent()).error)return[2,v];c.label=13;case 13:return i=!0,[3,8];case 14:return[3,17];case 15:return g=c.sent(),a=!0,s=g,[3,17];case 16:try{i||null==u.return||u.return()}finally{if(a)throw s}return[7];case 17:return[2,{error:null}]}})}).apply(this)},copyFileFromRemote:function(e,t,n){return(0,r._)(function(){var r,o;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return[4,n.readFile(e)];case 1:if((r=i.sent()).error)return[2,r];return[4,this.writeFile(t,r.content)];case 2:if((o=i.sent()).error)return[2,o];return[2,{error:null}]}})}).apply(this)},deleteFile:function(e){return(0,r._)(function(){var t,n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,ee({remove:{path:e.toString()}},{isMutative:!0})];case 1:if((t=r.sent()).error){if(!(n=R(t.error,[F.Df.NotFound])))throw Error(t.error);return[2,{error:n}]}return en({eventType:F.kS.Delete,node:{path:e,type:F.Tv.File}}),[2,{error:null}]}})})()},deleteDir:function(e){return(0,r._)(function(){var t,n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,ee({remove:{path:e.toString()}},{isMutative:!0})];case 1:if((t=r.sent()).error){if(!(n=R(t.error,[F.Df.NotFound])))throw Error(t.error);return[2,{error:n}]}return en({eventType:F.kS.Delete,node:{path:e,type:F.Tv.Directory}}),[2,{error:null}]}})})()},readDir:function(e){return(0,r._)(function(){var t,n,r;return(0,c.Jh)(this,function(o){switch(o.label){case 0:return[4,ee({readdir:{path:e.toString()}},{isMutative:!1})];case 1:if((n=o.sent()).error){if(!(r=R(n.error,[F.Df.NotFound,F.Df.NotDirectory,F.Df.FileSystemUnavailable])))throw Error(n.error);return[2,{error:r}]}if(!(null===(t=n.files)||void 0===t?void 0:t.files))throw Error("Expected filesChannel");return[2,{children:n.files.files.map(function(e){if(!e.path)throw Error("Expected path");return{filename:(0,y.Bf)((0,y.S1)(e.path)),type:e.type===l.api.File.Type.DIRECTORY?F.Tv.Directory:F.Tv.File}}),error:null}]}})})()},stat:function(e){return(0,r._)(function(){var t;return(0,c.Jh)(this,function(n){switch(n.label){case 0:return[4,ee({stat:{path:e.toString()}},{isMutative:!1})];case 1:if((t=n.sent()).error)throw Error(t.error);if(!t.statRes)throw Error("expected stat result");if(!t.statRes.exists)return[2,{exists:!1}];if(t.statRes.type===l.api.File.Type.DIRECTORY)return[2,{exists:!0,type:F.Tv.Directory,lastModified:new Date(1e3*t.statRes.modTime)}];return[2,{exists:!0,type:F.Tv.File,lastModified:new Date(1e3*t.statRes.modTime),byteLength:Number(t.statRes.size)}]}})})()},watchTextFile:function(e,t){var n=this;if((0,y.C_)((0,y.S1)(e)))throw Error("Cannot watch root directory");var a=A.get(e);if(a||(a={path:e,type:F.Tv.File,listeners:[],otClient:ea(e)},A.set(e,a)),!a)throw Error("Expected watchedOtFile");var l=!1,f=!1,d=function(){},h=[],p=function(o){if(d(),!a)throw Error("Expected watchedOtFile");var i,m,y,C,w,E=function(e){var n;return null===(n=t.onFlush)||void 0===n?void 0:n.call(t,e)};a.otClient.on("commitComplete",E);var b=function(){var e;return null===(e=t.onStatusChange)||void 0===e?void 0:e.call(t,F.KF.Dirty)};a.otClient.on("fileDirty",b);var S=function(){var e;return null===(e=t.onStatusChange)||void 0===e?void 0:e.call(t,F.KF.Clean)};a.otClient.on("fileClean",S);var _=function(){var e;return null===(e=t.onStatusChange)||void 0===e?void 0:e.call(t,F.KF.Syncing)};a.otClient.on("commitStart",_);var D=function(e){var n;return null===(n=t.onCursor)||void 0===n?void 0:n.call(t,e)};a.otClient.on("cursor",D);var k=function(e){var n;return null===(n=t.onRemoveCursor)||void 0===n?void 0:n.call(t,e)};a.otClient.on("removeCursor",k);var T=function(e){var n;return null===(n=t.onFileSavedChanged)||void 0===n?void 0:n.call(t,e)};a.otClient.on("fileSavedChanged",T);var O=(i=(0,r._)(function(t){var r,o,i,s,u,l,f,d,p,v,m,y;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if(!a)throw Error("Expected watchedOtFile");return(r=a.otClient).destroy(),o=ea(e),[4,new Promise(function(e,t){o.once("changes",function(){return e()}),o.once("error",function(e){return t(e)})})];case 1:if(c.sent(),i=r.getLocalContent(),s=o.getLocalContent(),u="local"===t?(0,g.F)(s,i):null,l="remote"===t?(0,g.F)(i,s):null,!a)throw Error("Expected watchedOtFile");a.otClient=o,f=!0,d=!1,p=void 0;try{for(v=a.listeners[Symbol.iterator]();!(f=(m=v.next()).done);f=!0)(0,m.value.reregister)(l)}catch(e){d=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(d)throw p}}for(u&&o.writeChanges(u);h.length>0;)null===(y=h.pop())||void 0===y||y({isDisposed:!1});return[4,n.flush()];case 2:return c.sent(),[2]}})}),function(e){return i.apply(this,arguments)}),R=function(e){var n;return null===(n=t.onReconnectFail)||void 0===n?void 0:n.call(t,O,e)};a.otClient.on("promptUserReconnect",R),a.listeners[0].reregister===p&&a.otClient.on("promptUserReconnect",function(){if(A.has(e)){if(!a)throw Error("Expected watchedOtFile");a.listeners.some(function(e){return e.onReconnectFail})||O("remote")}});var M=function(e,n){t.onError&&t.onError(e,n),v()};a.otClient.on("error",M);var P=function(n,r){if(n===F.Df.DiskQuotaExceeded&&er({eventType:F.kS.Modify,node:{path:e,type:F.Tv.File}}),t.onError){var o=Error(r);o.code=n,t.onError(o)}v()};a.otClient.on("fsError",P);var L=function(e,n){if(!a)throw Error("Expected watchedOtFile");x=!0;var r=u.as.of(e,a.otClient.getLocalContent().length,"\n");a.otClient.writeChanges(r,n);var o=!0,i=!1,s=void 0;try{for(var c,l=a.listeners[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value.onChange;f&&f!==t.onChange&&f({changes:r,changeSource:F.Fl.Local,version:a.otClient.version,latestContent:a.otClient.getLocalContent()})}}catch(e){i=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw s}}},N=(m=(0,r._)(function(){return(0,c.Jh)(this,function(e){return(null==a?void 0:a.otClient.isReconnecting)?[2,new Promise(function(e,t){if(!a){t(Error("Expected watchedOtFile"));return}h.push(e)})]:[2,{isDisposed:l}]})}),function(){return m.apply(this,arguments)}),I=function(){for(;h.length>0;){var e;null===(e=h.pop())||void 0===e||e({isDisposed:!1})}};a.otClient.on("transparentReconnect",I);var J=(y=(0,r._)(function(){var e,t,n,r,o,i=arguments;return(0,c.Jh)(this,function(c){switch(c.label){case 0:for(t=Array(e=i.length),n=0;n<e;n++)t[n]=i[n];if(!a)throw Error("Expected watchedOtFile");c.label=1;case 1:return c.trys.push([1,3,,4]),[4,N()];case 2:if(c.sent().isDisposed)return[2,{isDisposed:!0,result:null}];return[3,4];case 3:if(o=c.sent(),l)return[2,{isDisposed:!0,result:null}];throw o;case 4:return[4,(r=a.otClient).fetchChanges.apply(r,(0,s._)(t))];case 5:return[2,{isDisposed:!1,result:c.sent()}]}})}),function(){return y.apply(this,arguments)}),U=(C=(0,r._)(function(){var e,t,n,r,o=arguments;return(0,c.Jh)(this,function(i){switch(i.label){case 0:for(t=Array(e=o.length),n=0;n<e;n++)t[n]=o[n];if(!a)throw Error("Expected watchedOtFile");return[4,N()];case 1:if(i.sent().isDisposed)throw Error("File was disposed");return[2,(r=a.otClient).transformSelection.apply(r,(0,s._)(t))]}})}),function(){return C.apply(this,arguments)}),B=function(e){if(!a)throw Error("Expected watchedOtFile");a.otClient.updateCursors(e)};-1!==a.otClient.version&&setTimeout(function(){var e;if(!f){if(!a)throw Error("Expected watchedOtFile");f=!0,null===(e=t.onReady)||void 0===e||e.call(t,{initialContent:a.otClient.getLocalContent(),writeChange:L,updateSelections:B,fetchChanges:J,transformSelection:U,version:a.otClient.version})}}),o&&(null===(w=t.onChange)||void 0===w||w.call(t,{changes:o,changeSource:F.Fl.Container,version:a.otClient.version,latestContent:a.otClient.getLocalContent()}));var Z=function(e){var n,r;if(!a)throw Error("Expected watchedOtFile");if(!f){f=!0,null===(r=t.onReady)||void 0===r||r.call(t,{initialContent:a.otClient.getLocalContent(),writeChange:L,updateSelections:B,fetchChanges:J,transformSelection:U,version:a.otClient.version});return}null===(n=t.onChange)||void 0===n||n.call(t,{changes:e,changeSource:F.Fl.Container,version:a.otClient.version,latestContent:a.otClient.getLocalContent()})};a.otClient.on("changes",Z),d=function(){if(!a)throw Error("Expected watchedOtFile");a.otClient.removeListener("commitComplete",E),a.otClient.removeListener("fileDirty",b),a.otClient.removeListener("fileClean",S),a.otClient.removeListener("commitStart",_),a.otClient.removeListener("error",M),a.otClient.removeListener("fsError",P),a.otClient.removeListener("changes",Z),a.otClient.removeListener("cursor",D),a.otClient.removeListener("removeCursor",k),a.otClient.removeListener("promptUserReconnect",R),a.otClient.removeListener("transparentReconnect",I),a.otClient.removeListener("fileSavedChanged",T)},K()},v=function(){for(;h.length>0;){var t;null===(t=h.pop())||void 0===t||t({isDisposed:!0})}if(!l&&A.has(e)){if(l=!0,f=!0,d(),!a)throw Error("Expected watchedOtFile");a.listeners=a.listeners.filter(function(e){return e.dispose!==v}),0===a.listeners.length&&(a.otClient.destroy(),A.delete(e))}};return a.listeners.push((0,i._)((0,o._)({},t),{dispose:v,reregister:p})),p(null),v},watchFile:function(e,t){if((0,y.C_)((0,y.S1)(e)))throw Error("Cannot watch root directory");var n=!1,r=function(){n=!0;var t=U.get(e);t&&(t.listeners=t.listeners.filter(function(e){return e.dispose!==r}),0===t.listeners.length&&U.delete(e))};return es.readFile(e).then(function(a){if(!n){if(a.error){var s=Error(a.error);s.code=a.error,t.onError&&t.onError(s),r();return}var c=U.get(e);if(!c&&(c={path:e,type:F.Tv.File,listeners:[],latestContent:a.content},U.set(e,c),T&&T.send({subscribeFile:{files:[{path:e.toString()}]}})),!c)throw Error("Expected watched file");c.listeners.push((0,i._)((0,o._)({},t),{dispose:r})),t.onChange(a.content)}}),r},listFiles:function(){return(0,r._)(function(){var e;return(0,c.Jh)(this,function(t){switch(t.label){case 0:if(M&&E.performance.now()-P<1e4)return[2,M];return O||(O=function(){return eo.apply(this,arguments)}(),P=E.performance.now()),[4,O];case 1:return e=t.sent(),O=null,[2,e]}})})()},flush:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F.WL.UNKNOWN;return(0,r._)(function(){var n,o,i,a,s,u,l,f,d,h,p,v,g,m,y,C,w,E,b,S,_,D,k,x,T,F,O,R,M,P;return(0,c.Jh)(this,function(L){switch(L.label){case 0:var N;if(N=(0,r._)(function(e){var n,r,o,i,a,s,u,l;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if(n=e.path,!(r=Z.get(n)))return[2];o=!0,i=!1,a=void 0,c.label=1;case 1:c.trys.push([1,6,7,8]),s=r[Symbol.iterator](),c.label=2;case 2:if(o=(u=s.next()).done)return[3,5];return[4,(0,u.value)(e.otClient.getLocalContent(),t)];case 3:c.sent(),c.label=4;case 4:return o=!0,[3,2];case 5:return[3,8];case 6:return l=c.sent(),i=!0,a=l,[3,8];case 7:try{o||null==s.return||s.return()}finally{if(i)throw a}return[7];case 8:return[2]}})}),n=function(e){return N.apply(this,arguments)},o=[],i=function(e){null===e.otClient.channel||e.otClient.isReconnecting||o.push(e.otClient.flush())},void 0!==e)return[3,9];a=!0,s=!1,u=void 0,L.label=1;case 1:L.trys.push([1,6,7,8]),l=A.values()[Symbol.iterator](),L.label=2;case 2:if(a=(f=l.next()).done)return[3,5];return d=f.value,[4,n(d)];case 3:L.sent(),L.label=4;case 4:return a=!0,[3,2];case 5:return[3,8];case 6:return h=L.sent(),s=!0,u=h,[3,8];case 7:try{a||null==l.return||l.return()}finally{if(s)throw u}return[7];case 8:p=!0,v=!1,g=void 0;try{for(m=A.values()[Symbol.iterator]();!(p=(y=m.next()).done);p=!0)C=y.value,i(C)}catch(e){v=!0,g=e}finally{try{p||null==m.return||m.return()}finally{if(v)throw g}}return[3,18];case 9:w=!0,E=!1,b=void 0,L.label=10;case 10:L.trys.push([10,15,16,17]),S=e[Symbol.iterator](),L.label=11;case 11:if(w=(_=S.next()).done)return[3,14];if(D=_.value,!(void 0!==(k=A.get(D))))return[3,13];return[4,n(k)];case 12:L.sent(),L.label=13;case 13:return w=!0,[3,11];case 14:return[3,17];case 15:return h=L.sent(),E=!0,b=h,[3,17];case 16:try{w||null==S.return||S.return()}finally{if(E)throw b}return[7];case 17:x=!0,T=!1,F=void 0;try{for(O=e[Symbol.iterator]();!(x=(R=O.next()).done);x=!0)M=R.value,P=A.get(M),void 0!==P&&i(P)}catch(e){T=!0,F=e}finally{try{x||null==O.return||O.return()}finally{if(T)throw F}}L.label=18;case 18:return L.trys.push([18,20,,21]),[4,Promise.all(o.concat(Y))];case 19:case 20:return L.sent(),[3,21];case 21:return[2]}})})()},registerOnBeforeFlush:function(e,t){var n,r=null!==(n=Z.get(e))&&void 0!==n?n:new Set;return r.add(t),Z.set(e,r),function(){var n;return null===(n=Z.get(e))||void 0===n?void 0:n.delete(t)}},persist:function(e){var t=q();return e&&e.skipDebounce&&q.flush(),t},getOTVersion:function(e){if(e===J)return 123;var t=A.get(e);if(!t)throw Error("No file with path ".concat(e," found."));return t.otClient.version},isFileOrDirSaved:function(e){if((0,C.Mb)(e)){var t=A.get(e);return!t||t.otClient.isFileSaved()}return!0},onDiskQuotaExceeded:function(e){return B.push(e),function(){B=B.filter(function(t){return t!==e})}}};return es}},6498:function(e,t,n){"use strict";n.d(t,{ed:function(){return a},f5:function(){return u},gR:function(){return o},mt:function(){return s},tT:function(){return l},ug:function(){return i}});var r=n(80403);function o(e){return e.map(function(e){return"object"==typeof e?{delete:e.d}:"number"==typeof e?{skip:e}:{insert:e}})}function i(e){return e.map(function(e){if("delete"in e&&e.delete)return{d:e.delete};if("skip"in e&&e.skip)return e.skip;if("insert"in e&&"string"==typeof e.insert)return e.insert;throw Error("Unexpected op type")})}function a(e,t){var n=[],r=t,o=0,i=0,a=0,s=0,c=function(e){var n=e-i;if(e<i)throw Error("expected changeset to be ordered");for(var r=i+a;r<i+n+a;r++){var o=t.charCodeAt(r);o>=55296&&o<=57343?(s++,r++):13===o&&10===t.charCodeAt(r+1)&&(a++,r++)}i+=n};return e.iterChanges(function(e,t,u,l,f){if(e>0){var d=i+a,h=d-s;c(e);var p=i+a,v=p-s;n.push(v-h),o+=p-d}if(e!==t){var g=i+a,m=g-s;c(t);var y=i+a,C=y-s;n.push({d:C-m}),r=r.slice(0,o)+r.slice(o+(y-g))}if(f.length){var w=f.sliceString(0);n.push(w),r=r.slice(0,o)+w+r.slice(o),o+=w.length}}),{op:n,docAfter:r}}function s(e,t){var n=[],o=t,i=0,a=0,s=0,c=0,u=function(e){for(var n=a+s;n<a+e+s;n++){var r=t.charCodeAt(n);r>=55296&&r<=57343?(s++,n++):13===r&&10===t.charCodeAt(n+1)&&(c++,n++)}a+=e},f=!0,d=!1,h=void 0;try{for(var p,v,g=e[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){var m=v.value;if("string"==typeof m){var y=m;o=o.slice(0,i)+y+o.slice(i),i+=y.length;var C=a+s;if(y.endsWith("\r")&&"\n"===t.slice(C,C+1)&&(y=y.slice(0,-1),0===y.length))continue;var w=l(y),E=C-c;(null==p?void 0:p.to)===E?p.insert=p.insert?p.insert.append(w):w:(p={from:C-c,insert:w},n.push(p))}else if("number"==typeof m){var b=s;u(m);var S=s-b;i+=m+S}else if("d"in m){var _=a+s,D=c;u(m.d);var k=a+s,x=k-_;o=o.slice(0,i)+o.slice(i+x);var T=_-D,F=k-c;if("\r\n"===t.slice(_-1,_+1)&&(T+=1,(F-=1)-T<=0))continue;(null==p?void 0:p.to)===T?p.to=F:(p={from:T,to:F},n.push(p))}}}catch(e){d=!0,h=e}finally{try{f||null==g.return||g.return()}finally{if(d)throw h}}if(a+s!==t.length){var O=t.slice(a+s);c+=O.split("\r\n").length-1}return{changes:r.as.of(n,t.length-c),docAfter:o}}var c=/\r\n?|\n/;function u(e){return e.replaceAll("\r\n","\n").replaceAll("\r","\n")}function l(e){return r.xv.of(e.split(c))}},95938:function(e,t,n){"use strict";n.d(t,{nh:function(){return i},uP:function(){return o}});var r=n(63257),o=["package.json","package-lock.json","yarn.lock","bun.lockb","node_modules","pnpm-lock.yaml","poetry.lock","pyproject.toml","requirements.txt",".venv",".pythonlibs","go.mod","go.sum","Gemfile","Gemfile.lock","pom.xml","target","Rconfig.json","Rconfig.lock.json","composer.json","composer.lock","vendor",".upm"],i=[".replit","replit.nix"];t.ZP=(0,r._)(o).concat((0,r._)(i))},44816:function(){}}]);
//# sourceMappingURL=6641-5f5557e4826d4930.js.map